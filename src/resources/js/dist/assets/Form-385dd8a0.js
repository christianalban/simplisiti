import{i as x,v as j,b as de,g as re,d as pe}from"./helpers-d7cd10d6.js";import{d as F,e as h,f as D,r as L,o as i,c as b,h as t,A as w,I as me,a,j as M,t as p,v as G,l as k,J as ve,_ as B,k as P,w as V,n as T,g as J,y as N,z as be,F as W,i as fe,p as K,m as H,K as ge,L as q}from"./index-53847a5f.js";import{D as R}from"./vuedraggable.umd-51241ac4.js";import{g as he}from"./ComponentService-e247c513.js";import{C as _e,_ as $e}from"./ComponentFloatingPreview-782cec27.js";import{g as Q,p as Y,a as ye,u as Ce,b as we}from"./LocalStorageService-68aa5176.js";import{u as Z,_ as ke}from"./ComponentPreview.vue_vue_type_script_setup_true_lang-55d3db3a.js";import{u as Se}from"./ResourceService-7d3a1bfa.js";import{u as Ie}from"./PageService-d0a72512.js";const Ve=["onMousedown"],ze=F({__name:"FloatToolbar",props:{position:{type:String,default:"top"},isInvisible:{type:Boolean,default:!1},showLabel:{type:String},hiddeLabel:{type:String},canResize:{type:Boolean,default:!1}},emits:["update:isInvisible"],setup(e){const d=e,o=h(Q("float-toolbar-width",500)),s=h(x()),f=D(()=>`position-${d.position}-0`),_=D(()=>{switch(d.position){case"left":return"position-left";case"right":return"position-right";case"top":return"position-top";case"bottom":return"position-bottom"}}),l=n=>{const v=n.clientX,c=o.value,g=E=>{const A=d.position==="left"?c+(E.clientX-v):c-(E.clientX-v);o.value=A<200?200:A,Y("float-toolbar-width",o.value)},$=()=>{window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",$)};window.addEventListener("mousemove",g),window.addEventListener("mouseup",$)},m=D(()=>s.value?"100%":d.canResize&&!d.isInvisible?`${o.value}px`:`${["left","right"].includes(d.position)?"initial":"100%"}`);return(n,v)=>{const c=L("fa-icon");return i(),b("div",{style:ve({width:m.value}),class:w(["float-toolbar",_.value,f.value,{"float-toolbar-top":e.position==="top","float-toolbar-right":["left","right"].includes(e.position)}])},[t("div",{class:w(["float-toolbar-container",{"float-toolbar-container-vertical":["top","bottom"].includes(e.position)}])},[t("div",{class:w(["float-toolbar-accordion",{"float-toolbar-accordion-contracted":e.isInvisible,"float-toolbar-accordion-contracted-vertical":e.isInvisible&&["top","bottom"].includes(e.position),"float-toolbar-accordion-contracted-horizontal ":e.isInvisible&&["left","right"].includes(e.position)}])},[t("div",{class:w(["float-toolbar-content",{"rounded-top":e.position==="top","rounded-bottom":e.position==="bottom","rounded-left":e.position==="left","rounded-right":e.position==="right"}])},[me(n.$slots,"default",{},void 0,!0)],2)],2),t("div",{class:w(["float-toolbar-buttons",{"float-toolbar-buttons-vertical":["top","bottom"].includes(e.position),"float-toolbar-buttons-horizontal":["left","right"].includes(e.position),left:e.position==="left",right:e.position==="right",bottom:e.position==="bottom",top:e.position==="top"}])},[t("button",{class:w(["float-toolbar-button",{"vertical-mode":["left","right"].includes(e.position)}]),type:"button",onClick:v[0]||(v[0]=g=>n.$emit("update:isInvisible",!e.isInvisible))},[a(c,{icon:e.isInvisible?"eye":"eye-slash"},null,8,["icon"]),M(" "+p(e.isInvisible?e.showLabel||n.$t("buttons.show"):e.hiddeLabel||n.$t("buttons.hide")),1)],2)],2)],2),e.canResize?(i(),b("div",{key:0,class:"border-l-2 border-l-gray-400 hover:border-l-blue-500 transition-colors h-full hover:cursor-col-resize",onMousedown:G(l,["prevent","stop"])},null,40,Ve)):k("",!0)],6)}}});const ee=B(ze,[["__scopeId","data-v-511c8ca4"]]),Te={class:"toolbar-container"},Le={class:"toolbar-actions"},Me={class:"flex gap-2"},Fe={type:"submit",class:"button primary"},Ue={class:"title"},De=["href"],Pe={class:"toolbar-route"},Be={class:"toolbar-route-input"},Ee={class:"label"},Ae=["value","placeholder"],Ne={class:"toolbar-route-input"},Re={class:"label"},We=["value","placeholder"],Xe={class:"toolbar-route-input"},je={class:"label"},qe=["value","placeholder"],Oe=F({__name:"PageToolbar",props:{showDelete:Boolean,title:String,name:{type:String,default:""},url:{type:String,default:""},pageTitle:{type:String,default:""}},emits:["delete","update:name","update:pageTitle","update:url"],setup(e){const d=h(!0);return(o,s)=>{const f=L("fa-icon"),_=L("router-link");return i(),P(ee,{isInvisible:d.value,"onUpdate:isInvisible":s[4]||(s[4]=l=>d.value=l),showLabel:o.$t("pages.buttons.settings")},{default:V(()=>[t("div",Te,[t("div",Le,[t("div",Me,[a(_,{class:"button secondary",to:{name:"pages.index"}},{default:V(()=>[a(f,{icon:"arrow-left"}),M(" "+p(o.$t("buttons.back")),1)]),_:1},8,["to"]),e.showDelete?(i(),b("button",{key:0,onClick:s[0]||(s[0]=l=>o.$emit("delete")),type:"button",class:"button danger"},p(o.$t("buttons.delete")),1)):k("",!0),t("button",Fe,p(o.$t("buttons.save")),1)]),t("h1",Ue,[M(p(e.title)+" ",1),e.showDelete?(i(),b("a",{key:0,href:e.url,target:"_blank"},[a(f,{icon:"external-link-alt"})],8,De)):k("",!0)])]),t("div",Pe,[t("div",Be,[t("label",Ee,p(o.$t("pages.labels.pageName")),1),t("input",{class:"input",type:"text",required:"",value:e.name,onInput:s[1]||(s[1]=l=>o.$emit("update:name",T(j)(l.target))),placeholder:o.$t("pages.placeholders.pageName")},null,40,Ae)]),t("div",Ne,[t("label",Re,p(o.$t("pages.labels.pageTitle")),1),t("input",{class:"input",type:"text",value:e.pageTitle,onInput:s[2]||(s[2]=l=>o.$emit("update:pageTitle",T(de)(l.target))),placeholder:o.$t("pages.placeholders.pageTitle")},null,40,We)]),t("div",Xe,[t("label",je,p(o.$t("pages.labels.pageUrl")),1),t("input",{class:"input",type:"text",value:e.url,onInput:s[3]||(s[3]=l=>o.$emit("update:url",T(j)(l.target))),placeholder:o.$t("pages.placeholders.pageUrl")},null,40,qe)])])])]),_:1},8,["isInvisible","showLabel"])}}});const Pt=B(Oe,[["__scopeId","data-v-48fae850"]]),xe=["placeholder"],Ge={class:"overflow-y-auto mt-2"},Je={class:"tile h-24 cursor-pointer flex flex-col"},Ke={class:"flex items-center justify-between px-2 py-1"},He={class:"flex flex-col"},Qe={class:"font-semibold"},Ye=F({__name:"AvailableComponents",setup(e){const d=h([]),o=D(()=>re(d.value)),s=h(!1),f=h(""),_=m=>{const n={};m.variables.forEach(c=>{n[c.name]=null});const v={id:m.id||1+1,...m,variables:m.variables.map(c=>({...c})),content:n};return delete v.content_id,v},l=()=>{s.value=!0,he({withData:!0}).then(m=>{d.value=m.data.data}).finally(()=>{s.value=!1})};return J(()=>{l()}),(m,n)=>{const v=L("fa-icon");return i(),b(W,null,[t("button",{onClick:l,type:"button",class:"button secondary"},[a(v,{icon:"sync",class:w({"animate-spin":s.value})},null,8,["class"]),M(" "+p(m.$t("components.buttons.refresh")),1)]),N(t("input",{"onUpdate:modelValue":n[0]||(n[0]=c=>f.value=c),type:"search",class:"input mt-4",placeholder:m.$t("placeholders.search")},null,8,xe),[[be,f.value]]),t("div",Ge,[a($e,{items:o.value,filter:f.value},{default:V(c=>[a(T(R),{class:"grid grid-cols-2 gap-4",modelValue:c.item,"onUpdate:modelValue":g=>c.item=g,group:{name:"components",pull:"clone",put:!1},sort:!1,clone:_,"item-key":"id"},{item:V(({element:g,index:$})=>[t("div",Je,[t("div",Ke,[t("div",He,[t("span",Qe,p(T(pe)(g.name)),1)])]),a(_e,{component:g,class:"flex-1 tile-title cursor-pointer active:cursor-grabbing",position:$%2===0?"left":"right"},null,8,["component","position"])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["items","filter"])])],64)}}}),Ze={key:0,class:"component-configuration-parameters"},et={class:"component-configuration-label"},tt={class:"max-h-[4rem] flex overflow-hidden"},ot=F({__name:"ComponentConfigurationForm",props:{component:{type:Object},position:{type:String,default:"left"}},emits:["update:position"],setup(e,{emit:d}){const o=Z(),s=(_,l)=>{_.content&&(_.content[l]=null)},f=()=>{o.update()};return(_,l)=>{const m=L("fa-icon");return e.component?(i(),b("div",Ze,[(i(!0),b(W,null,fe(e.component.variables,n=>(i(),b("div",{key:n.name},[t("div",et,[t("label",null,p(n.name)+":",1),a(m,{class:"component-configuration-set-default",icon:"arrows-rotate",onClick:v=>s(e.component,n.name)},null,8,["onClick"])]),t("div",tt,[e.component.content?(i(),P(ye,{key:0,editStructure:!1,modelValue:e.component.content[n.name],"onUpdate:modelValue":[v=>e.component.content[n.name]=v,f],"default-value":n.default,name:n.name,type:n.type},null,8,["modelValue","onUpdate:modelValue","default-value","name","type"])):k("",!0)])]))),128))])):k("",!0)}}});const nt=B(ot,[["__scopeId","data-v-53195aea"]]),st=e=>(K("data-v-e8ede51d"),e=e(),H(),e),at=st(()=>t("hr",null,null,-1)),it=F({__name:"PageSectionButtonAdd",emits:["click"],setup(e){return(d,o)=>{const s=L("fa-icon");return i(),b("button",{class:"page-sections-buttons-add",onClick:o[0]||(o[0]=G(f=>d.$emit("click"),["stop"])),type:"button"},[at,t("span",null,[a(s,{icon:"square-plus"}),M(" "+p(d.$t("pages.buttons.addSection")),1)])])}}});const O=B(it,[["__scopeId","data-v-e8ede51d"]]),lt=e=>(K("data-v-d2f8783b"),e=e(),H(),e),ct={class:"w-full p-4 flex flex-col h-[60vh] md:h-full"},ut={class:"form-group"},dt={class:"page-sections-container"},rt={class:"page-sections-content"},pt={class:"page-sections-item-panel"},mt={class:"page-sections-preview"},vt=["onClick"],bt=lt(()=>t("div",{class:"absolute inset-0 cursor-pointer transition-colors hover:bg-yellow-400 active:bg-yellow-200 opacity-50 z-10"},null,-1)),ft={class:"page-sections-item-buttons"},gt={class:"pages-secttions-component-buttons"},ht=["onClick"],_t={class:"page-sections-label"},$t={class:"hideable-header"},yt={class:"page-sections-buttons"},Ct={key:0},wt={key:1},kt=["onClick"],St=F({__name:"Form",props:{sections:{type:Array,default:()=>[{order:0,components:[]},{order:1,components:[]}]},pageEditionMode:{type:String,default:"adding-component"}},emits:["update:sections"],setup(e,{emit:d}){const{loadResources:o}=Se(),{loadSources:s}=Ce(),{loadActions:f}=we(),{loadPages:_}=Ie(),l=Z(),m=e,n=h(!0),v=d,c=h(null),g=h(null),$=h("adding-component"),E=u=>{const r=[...m.sections];r.splice(u,0,q({order:0,components:[]})),v("update:sections",r)},A=()=>{v("update:sections",[...m.sections,q({order:0,components:[]})])},te=u=>{const r=[...m.sections];r.splice(u,1),v("update:sections",r)},oe=(u,r)=>{u.splice(r,1)},ne=(u,r)=>{n.value=!1,$.value="editing-component",c.value=u,g.value=r,l.attach(u)},se=()=>{n.value=!0,$.value="adding-component",l.detach(),c.value=null,g.value=null},ae=(u,r)=>{var S,U;return((S=c.value)==null?void 0:S.id)===u.id&&u.order===((U=c.value)==null?void 0:U.order)&&g.value===r},X=h(x()),z=h(Q("float-toolbar-position",X.value?"bottom":"left")),ie=()=>{z.value=z.value==="left"?"right":"left",Y("float-toolbar-position",z.value)},le=D(()=>$.value==="adding-component"?"availableComponents":"componentConfigurationForm");return J(()=>{o(),s(),f(),_()}),(u,r)=>{const S=L("fa-icon"),U=ge("autosize");return i(),b(W,null,[a(ee,{isInvisible:n.value,"onUpdate:isInvisible":r[1]||(r[1]=y=>n.value=y),position:z.value,showLabel:u.$t($.value==="editing-component"?"pages.buttons.settings":"pages.buttons.components"),canResize:!0},{default:V(()=>[t("div",ct,[t("div",{class:w(`component-configuration-title ${z.value}`)},[t("h2",null,p(u.$t(`pages.titles.${le.value}`)),1),t("div",null,[t("div",ut,[t("button",{type:"button",class:"button small default",onClick:se},p(u.$t("pages.buttons.exit")),1),X.value?k("",!0):(i(),b("button",{key:0,type:"button",class:"button small default button-position",onClick:ie},[a(S,{icon:"arrows-down-to-line"})]))])])],2),$.value==="adding-component"?(i(),P(Ye,{key:0})):k("",!0),$.value==="editing-component"?(i(),P(nt,{key:1,position:z.value,"onUpdate:position":r[0]||(r[0]=y=>z.value=y),component:c.value},null,8,["position","component"])):k("",!0)])]),_:1},8,["isInvisible","position","showLabel"]),t("div",dt,[t("div",rt,[a(T(R),{list:e.sections,class:"page-sections-panel",onInput:r[2]||(r[2]=y=>u.$emit("update:sections",y)),group:"sections","item-key":"id"},{item:V(({element:y,index:C})=>[t("div",{class:w(["page-sections-list-content",{"page-sections-list-header":!C,"page-sections-list-footer":C===e.sections.length-1}])},[C?(i(),P(O,{key:0,onClick:I=>E(C)},null,8,["onClick"])):k("",!0),t("div",pt,[a(T(R),{class:"page-sections-dreaggable",modelValue:y.components,"onUpdate:modelValue":I=>y.components=I,disabled:y.components.length===1,group:"components","item-key":"id"},{item:V(({element:I,index:ce})=>[t("div",{class:w(["page-sections-item",{"page-sections-item-selected":ae(I,C)}])},[N((i(),b("div",mt,[N((i(),b("div",{class:"page-sections-preview-content relative",onClick:ue=>ne(I,C)},[bt,a(ke,{component:I,lazy:!0},null,8,["component"])],8,vt)),[[U]]),t("div",ft,[t("div",gt,[t("button",{type:"button",onClick:ue=>oe(y.components,ce)},[a(S,{icon:"trash"})],8,ht),t("span",_t,p(I.name),1)])])])),[[U]])],2)]),header:V(()=>[t("div",$t,[a(S,{icon:"triangle-exclamation"}),t("p",null,p(u.$t("pages.labels.addComponentsToSection",{section:C})),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"]),t("div",yt,[C?(i(),b("span",wt,p(u.$t(C===e.sections.length-1?"pages.labels.footer":"pages.labels.section",{section:y.order=C})),1)):(i(),b("span",Ct,[a(S,{icon:"heading"}),M(" "+p(u.$t("pages.labels.header")),1)])),t("button",{onClick:I=>te(C)},[a(S,{icon:"trash"})],8,kt)])])],2)]),_:1},8,["list"]),a(O,{onClick:A})])])],64)}}});const Bt=B(St,[["__scopeId","data-v-d2f8783b"]]);export{Pt as P,Bt as a};
