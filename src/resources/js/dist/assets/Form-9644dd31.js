import{_ as z}from"./CodeEditor.vue_vue_type_script_setup_true_lang-894c82a9.js";import{a as A,v as N}from"./helpers-73a2380c.js";import{u as D}from"./ResourceService-8695aaab.js";import{_ as E,a as O,g as k,u as W,b as j,p as H}from"./LocalStorageService-cad89000.js";import{u as P}from"./PageService-d08df8e8.js";import{b as L,d as B,x as Q,e as $,f as T,r as F,o as u,c as v,a as r,h as t,y as C,g as G,t as _,n as J,k as R,l as S,F as U,i as K,j as X,w as Y,_ as Z}from"./index-5f5f7cb7.js";import{_ as ee}from"./Modal.vue_vue_type_script_setup_true_lang-f62bcc73.js";import{_ as te}from"./Form.vue_vue_type_script_setup_true_lang-95827b3f.js";const q=e=>e?["datasource",null].includes(e):!1,ae=async(e,c)=>{const i=A(`component/${e}/variable/${c.name}/${c.type}/settings`,{withSettings:!0},{default:c.default});return await L.get(i)},oe={class:"form-group h-14"},se=["value","placeholder"],ne={class:"flex flex-col text-xs w-14"},le=["disabled"],de=["disabled"],ie=B({__name:"VariableConfigItem",props:{type:{type:String,required:!0},name:{type:String,required:!0},default:{type:[String,Number,Object,null,void 0],required:!0},showRemove:{type:Boolean,default:!0}},emits:["update:type","update:name","update:default","removeVariable","displaySettings"],setup(e,{emit:c}){const i=e,V=Q(),g=$(i.name),h=c,f=T(()=>q(i.type)),s=()=>{h("removeVariable")},b=()=>{ae(V.params.component,{type:i.type,name:i.name,default:i.default}).then(n=>{h("displaySettings",n.data.data)})},x=n=>g.value=N(n.target);return(n,l)=>{const w=F("fa-icon");return u(),v("div",oe,[r(E,{class:"w-20",modelValue:e.type,"onUpdate:modelValue":l[0]||(l[0]=m=>n.$emit("update:type",m))},null,8,["modelValue"]),t("input",{type:"text",class:"input w-32",value:g.value,onInput:l[1]||(l[1]=m=>x(m)),onBlur:l[2]||(l[2]=m=>n.$emit("update:name",g.value)),placeholder:n.$t("components.placeholders.name")},null,40,se),r(O,{class:"flex-1",modelValue:e.default,"onUpdate:modelValue":l[3]||(l[3]=m=>n.$emit("update:default",m)),name:e.name,type:e.type},null,8,["modelValue","name","type"]),t("div",ne,[t("button",{type:"button",class:C(["variable-button flex-1 rounded-tr",{"bg-blue-200 text-blue-900":f.value,"bg-blue-100 text-blue-300 cursor-not-allowed":!f.value}]),onClick:b,disabled:!f.value},[r(w,{icon:"gear"})],10,le),t("button",{type:"button",class:C(["variable-button flex-1 bg-red-200 text-red-900 rounded-br ",{"hover:bg-red-300 cursor-pointer":e.showRemove,"cursor-not-allowed":!e.showRemove}]),onClick:s,disabled:!e.showRemove},[r(w,{icon:"minus"})],10,de)])])}}}),ue={class:"flex flex-col gap-4 flex-1 overflow-hidden"},re={class:"flex flex-col gap-2 md:w-1/3"},me={class:"label"},pe=["value","placeholder"],ce={class:"flex flex-col-reverse md:flex-row gap-4 w-full flex-1 overflow-hidden py-2"},fe={class:"flex-1 flex flex-col overflow-hidden"},ve={class:"title mb-4"},ge={class:"flex gap-2"},be={key:0,class:"title"},ye={key:0,class:"flex flex-col flex-1 gap-2 bg-gray-100 p-2 rounded-lg overflow-y-auto"},he={key:1,class:"w-full mt-auto"},xe=B({__name:"Form",props:{code:{type:String,default:"<div>Hello World</div>"},variables:{type:Array,default:()=>[{type:"text",name:"",default:""}]},name:{type:String,default:""}},emits:["update:code","update:variables","update:name"],setup(e,{emit:c}){const{loadResources:i}=D(),{loadSources:V}=W(),{loadActions:g}=j(),{loadPages:h}=P(),f=e;console.log(k("variables-expanded",window.innerWidth>768));const s=$(k("variables-expanded",window.innerWidth>768)),b=$(!1),x=$([]),n=c,l=()=>{n("update:variables",[...f.variables,{type:"text",name:"",default:""}])},w=o=>{n("update:variables",f.variables.filter((d,y)=>y!==o))},m=(o,d)=>{q(o.type)&&(x.value=d||[],o.settings=d,b.value=!0)},I=()=>{s.value=!s.value,H("variables-expanded",s.value)};return G(()=>{i(),V(),g(),h()}),(o,d)=>{const y=F("fa-icon");return u(),v(U,null,[t("div",ue,[t("div",re,[t("label",me,_(o.$t("components.labels.componentName")),1),t("input",{type:"text",value:e.name,required:"",onInput:d[0]||(d[0]=a=>o.$emit("update:name",J(N)(a.target))),class:"input",placeholder:o.$t("components.placeholders.componentName")},null,40,pe)]),t("div",ce,[t("div",fe,[t("h2",ve,_(o.$t("components.titles.code")),1),r(z,{code:f.code,"onUpdate:code":d[1]||(d[1]=a=>o.$emit("update:code",a)),language:"html"},null,8,["code"])]),t("div",{class:C(["flex flex-col gap-2",{"md:w-4/12":s.value,"w-auto":!s.value}])},[t("div",ge,[t("button",{class:"button primary w-8 !p-0 aspect-square text-xs",type:"button",onClick:I},[s.value?(u(),R(y,{key:0,icon:"minimize"})):(u(),R(y,{key:1,icon:"maximize"}))]),s.value?(u(),v("h2",be,_(o.$t("components.titles.variables")),1)):S("",!0)]),s.value?(u(),v("div",ye,[(u(!0),v(U,null,K(e.variables,(a,M)=>(u(),v("div",{key:a.name},[r(ie,{type:a.type,"onUpdate:type":p=>a.type=p,name:a.name,"onUpdate:name":p=>a.name=p,default:a.default,"onUpdate:default":p=>a.default=p,showRemove:e.variables.length>1,onRemoveVariable:p=>w(M),onDisplaySettings:p=>m(a,p)},null,8,["type","onUpdate:type","name","onUpdate:name","default","onUpdate:default","showRemove","onRemoveVariable","onDisplaySettings"])]))),128))])):S("",!0),s.value?(u(),v("div",he,[t("button",{type:"button",class:"variable-button bg-teal-200 hover:bg-teal-300 text-teal-900 w-full rounded",onClick:l},[r(y,{icon:"plus"}),X(" "+_(o.$t("components.buttons.addVariable")),1)])])):S("",!0)],2)])]),r(ee,{title:o.$t("titles.settings"),showModal:b.value,"onUpdate:showModal":d[2]||(d[2]=a=>b.value=a),resetOnClose:!1},{default:Y(()=>[r(te,{settingMenu:x.value},null,8,["settingMenu"])]),_:1},8,["title","showModal"])],64)}}});const Ue=Z(xe,[["__scopeId","data-v-d075bc66"]]);export{Ue as C};
