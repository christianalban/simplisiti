import{e as S,b as G,d as j,o as a,c as r,h as t,t as v,f as N,r as J,a as w,v as z,w as K,y as Q,j as O,A as ae,H as se,F as k,i as U,g as ne,E as F,k as E,l as M,M as ue,_ as re,n as C,D as ce}from"./index-5f5f7cb7.js";import{_ as W}from"./Modal.vue_vue_type_script_setup_true_lang-f62bcc73.js";import{u as de}from"./ResourceService-8695aaab.js";import{R as H}from"./ResourcePreview-b4a25d78.js";import{u as ie}from"./PageService-d08df8e8.js";import{v as me}from"./helpers-73a2380c.js";import{_ as pe}from"./Dialog.vue_vue_type_script_setup_true_lang-702f776d.js";const X=S([]),ve=async()=>await G.get("source"),fe=async()=>{const l=await ve();X.value=l.data.data},he=()=>({sources:X,loadSources:fe}),Y=S([]),ye=async()=>await G.get("action"),ge=async()=>{const l=await ye();Y.value=l.data.data},_e=()=>({actions:Y,loadActions:ge}),$e=["value"],Ve={value:"text"},be={value:"textarea"},we={value:"resource"},Ce={value:"datatable"},Se={value:"datasource"},ke={value:"action"},De={value:"page"},Re=j({__name:"VariableTypeSelector",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(l){const y=o=>o.target.value;return(o,d)=>(a(),r("select",{class:"input",value:l.modelValue,onChange:d[0]||(d[0]=p=>o.$emit("update:modelValue",y(p)))},[t("option",Ve,v(o.$t("components.types.text")),1),t("option",be,v(o.$t("components.types.textarea")),1),t("option",we,v(o.$t("components.types.resource")),1),t("option",Ce,v(o.$t("components.types.datatable")),1),t("option",Se,v(o.$t("components.types.datasource")),1),t("option",ke,v(o.$t("components.types.action")),1),t("option",De,v(o.$t("components.types.page")),1)],40,$e))}}),xe={class:"button secondary flex gap-2 w-full h-full flex-col justify-center !p-1 relative items-center"},qe={class:"w-full flex items-center justify-center max-h-full"},Me={class:"h-full w-full flex"},Ue=["onClick"],je={class:"flex flex-col md:flex-row gap-2 justify-between mb-4"},Ee=["placeholder"],Te={class:"grid grid-cols-2 md:grid-cols-4 gap-2 overflow-y-auto max-h-[70vh]"},Ie={class:"button primary aspect-square flex flex-col gap-2 justify-center items-center"},Le=["onClick"],Ne={class:"text-sm italic"},Ae=j({__name:"ResourcePicker",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(l,{emit:y}){const o=l,d=S(!1),p=S(""),i=S(!1),{resources:c,loadResources:n,resourceFromId:D}=de(),$=N(()=>c.value.filter(V=>{var R;return(R=V.name)==null?void 0:R.toLowerCase().includes(p.value.toLowerCase())})),_=N(()=>{if(!(o.modelValue===void 0||o.modelValue===null))return D(+o.modelValue)}),f=y,h=()=>{d.value=!0},g=V=>{f("update:modelValue",V),d.value=!1},A=()=>{i.value=!0,n().finally(()=>{i.value=!1})};return(V,R)=>{var T;const B=J("fa-icon");return a(),r(k,null,[t("div",xe,[t("div",qe,[t("div",Me,[w(H,{url:(T=_.value)==null?void 0:T.url},null,8,["url"])])]),t("button",{type:"button",onClick:z(h,["stop"]),class:"absolute bg-teal-500 hover:bg-teal-600 transition-colors rounded-lg text-white text-xs p-1 bg-opacity-75"},v(_.value?V.$t("components.buttons.changeResource"):V.$t("components.buttons.selectResource")),9,Ue)]),w(W,{title:V.$t("components.titles.selectResource"),showModal:d.value,"onUpdate:showModal":R[1]||(R[1]=x=>d.value=x),showCancel:!1,confirmLabel:V.$t("buttons.close")},{default:K(()=>[t("div",je,[t("button",{type:"button",onClick:A,class:"button secondary"},[w(B,{icon:"sync",class:Q({"animate-spin":i.value})},null,8,["class"]),O(" "+v(V.$t("resources.buttons.refresh")),1)]),ae(t("input",{type:"search","onUpdate:modelValue":R[0]||(R[0]=x=>p.value=x),class:"input",placeholder:V.$t("placeholders.search")},null,8,Ee),[[se,p.value]])]),t("div",Te,[(a(!0),r(k,null,U($.value,x=>(a(),r("div",Ie,[w(H,{url:x.url},null,8,["url"]),t("p",{onClick:z(I=>g(x.id),["stop"]),class:"hover:underline cursor-pointer"},[O(v(x.name)+" ",1),t("span",Ne,"("+v(V.$t("resources.buttons.select"))+")",1)],8,Le)]))),256))])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),Be={class:"overflow-y-auto h-[75vh] rounded"},Fe={class:"w-full relative"},Pe={class:"flex"},ze={class:"w-full form-group"},Oe=["value","onInput","placeholder","readonly"],He=["onClick"],Ge={class:"p-2 bg-gray-100 sticky top-0 z-10"},Je={class:"flex justify-center"},Ke={class:""},Qe={class:"p-2 transition-colors bg-gray-100 group-hover:bg-gray-200"},We={class:"flex flex-col gap-1"},Xe=["onClick"],Ye=j({__name:"DataTable",props:{modelValue:{required:!0},name:{type:String,required:!1},editStructure:{type:Boolean,default:!0}},emits:["update:model-value"],setup(l,{emit:y}){const o=l,d=[],p=({type:e,name:s}={type:"text",name:""})=>{let u="";return e==="datatable"&&(u={columns:[i()],rows:[[p()]]}),{name:s,type:e,value:"",default:u}},i=(e="text")=>({name:"",type:e}),c=S([i()]),n=S([[p()]]),D=S(!1),$=S(0),_=S(!1),f=y,h=()=>{_.value=!0},g=()=>{f("update:model-value",{columns:c.value,rows:n.value}),_.value=!1},A=(e,s,u)=>{s.type=u,n.value.forEach(m=>{m[e].type=s.type})},V=(e,s,u)=>{s.name=me(u),n.value.forEach(m=>{m[e].name=s.name})},R=()=>{c.value.push(i()),n.value.forEach(e=>{e.push(p())})},B=()=>{const e=[];c.value.forEach(({type:s,name:u})=>{e.push(p({type:s,name:u}))}),n.value.push(e),L()},T=e=>{c.value.splice(e,1),n.value.forEach(s=>{s.splice(e,1)})},x=e=>{n.value.splice(e,1)},I=()=>{n.value[0].forEach((e,s)=>{var u;e.type==="datatable"&&typeof e.default=="object"&&(d[s]=((u=e.default)==null?void 0:u.columns)||[i()])})},L=()=>{n.value.forEach(e=>{e.forEach((s,u)=>{var m;s.type==="datatable"&&s.default&&typeof s.default=="object"&&(s.default.columns=d[u]),s.name=((m=c.value[u])==null?void 0:m.name)||""})})},Z=N(()=>{var e;return((e=c.value[$.value])==null?void 0:e.name)||""}),ee=e=>{D.value=!0,$.value=e},te=()=>{T($.value),D.value=!1};return ne(()=>{if(o.modelValue&&typeof o.modelValue=="object"){const e=o.modelValue;c.value=e.columns,n.value=e.rows,n.value.length&&(I(),L())}}),F(()=>o.modelValue,e=>{if(e&&typeof e=="object"){const s=o.modelValue;c.value=s.columns,n.value=s.rows,n.value.length&&(I(),L())}}),F(c,e=>{n.value.forEach(s=>{for(let u=0;u<e.length;u++)e[u]||s.splice(u,1);e.forEach((u,m)=>{(!s[m]||s[m].type!==u.type)&&(s[m]=p({type:u.type,name:u.name}))})}),ue(()=>{I(),L()})},{deep:!0}),(e,s)=>{const u=J("fa-icon");return a(),r(k,null,[t("button",{onClick:h,type:"button",class:"button secondary flex items-center justify-center gap-2 w-full"},[t("span",null,v(e.$t("components.buttons.fillData")),1)]),w(W,{title:e.$t("components.titles.fillData"),showModal:_.value,"onUpdate:showModal":s[0]||(s[0]=m=>_.value=m),showCancel:!1,confirmLabel:e.$t("buttons.close"),resetOnClose:!1,onConfirm:g},{default:K(()=>[t("div",Be,[t("table",Fe,[t("thead",null,[t("tr",null,[(a(!0),r(k,null,U(c.value,(m,q)=>(a(),r("th",{class:Q(`p-2 bg-gray-100 sticky top-0 z-10 ${m.type}`)},[t("div",Pe,[t("div",ze,[t("input",{class:"input w-full",type:"text",value:m.name,onInput:b=>V(q,m,b.target),placeholder:e.$t("components.placeholders.dataName"),readonly:!l.editStructure},null,40,Oe),l.editStructure?(a(),E(Re,{key:0,class:"!pl-0 w-3",modelValue:m.type,"onUpdate:modelValue":b=>A(q,m,b)},null,8,["modelValue","onUpdate:modelValue"])):M("",!0),c.value.length>1&&l.editStructure?(a(),r("button",{key:1,type:"button",class:"button danger",onClick:b=>ee(q)},[w(u,{icon:"minus"})],8,He)):M("",!0)])])],2))),256)),t("th",Ge,[t("div",Je,[c.value.length>=1&&l.editStructure?(a(),r("button",{key:0,type:"button",class:"button primary",onClick:R},[w(u,{icon:"plus"})])):M("",!0)])])])]),t("tbody",null,[(a(!0),r(k,null,U(n.value,(m,q)=>(a(),r("tr",{class:"group",key:`${q}:${l.name}`},[(a(!0),r(k,null,U(m,(b,oe)=>{var P;return a(),r("td",{class:"p-2 transition-colors bg-gray-100 group-hover:bg-gray-200",key:`${l.name}:${(P=c.value[oe])==null?void 0:P.name}:${b.name}`},[t("div",Ke,[w(vt,{modelValue:b.default,"onUpdate:modelValue":le=>b.default=le,"edit-structure":l.editStructure,name:b.name,type:b.type},null,8,["modelValue","onUpdate:modelValue","edit-structure","name","type"])])])}),128)),t("td",Qe,[t("div",We,[n.value.length>1?(a(),r("button",{key:0,type:"button",class:"button danger",onClick:b=>x(q)},[w(u,{icon:"minus"})],8,Xe)):M("",!0),q==n.value.length-1?(a(),r("button",{key:1,type:"button",class:"button secondary",onClick:B},[w(u,{icon:"plus"})])):M("",!0)])])]))),128))])])])]),_:1},8,["title","showModal","confirmLabel"]),w(pe,{showDialog:D.value,"onUpdate:showDialog":s[1]||(s[1]=m=>D.value=m),title:e.$t("dialogs.delete.title"),message:e.$t("dialogs.delete.message",{name:Z.value}),onConfirm:te},null,8,["showDialog","title","message"])],64)}}});const Ze=re(Ye,[["__scopeId","data-v-fa82919c"]]),et=["value"],tt={value:""},ot=["value"],lt=j({__name:"DataSource",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(l,{emit:y}){const{sources:o}=he(),d=y,p=i=>{const c=i.target;d("update:model-value",c.value)};return(i,c)=>(a(),r("select",{class:"input w-full",onChange:p,value:l.modelValue},[t("option",tt,v(i.$t("placeholders.select")),1),(a(!0),r(k,null,U(C(o),n=>(a(),r("option",{value:n.name},v(n.name),9,ot))),256))],40,et))}}),at=["value"],st={value:""},nt=["value"],ut=j({__name:"Action",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(l,{emit:y}){const{actions:o}=_e(),d=y,p=i=>{const c=i.target;d("update:model-value",c.value)};return(i,c)=>(a(),r("select",{class:"input w-full",onChange:p,value:l.modelValue},[t("option",st,v(i.$t("placeholders.select")),1),(a(!0),r(k,null,U(C(o),n=>(a(),r("option",{value:n.name},v(n.name),9,nt))),256))],40,at))}}),rt=["value"],ct={value:""},dt=["value"],it=j({__name:"Page",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(l,{emit:y}){const{pages:o}=ie(),d=y,p=i=>{const c=i.target;d("update:model-value",c.value)};return(i,c)=>(a(),r("select",{class:"input w-full",onChange:p,value:l.modelValue},[t("option",ct,v(i.$t("placeholders.select")),1),(a(!0),r(k,null,U(C(o),n=>(a(),r("option",{value:n.name},v(n.title)+" - "+v(n.url),9,dt))),256))],40,rt))}}),mt=["value","placeholder"],pt=["placeholder"],vt=j({__name:"ControlTypeSelector",props:{type:{type:String,required:!0},modelValue:{required:!0},name:{type:String,required:!0},defaultValue:{type:[String,Number,Object,null,void 0]},class:{type:String},editStructure:{type:Boolean,default:!0}},emits:["update:model-value"],setup(l,{emit:y}){const o=l,d=y,p=f=>{d("update:model-value",f.target.value)},i=f=>{d("update:model-value",f)},c=f=>{d("update:model-value",f)},n=f=>{d("update:model-value",f)},D=f=>{d("update:model-value",f)},{type:$}=ce(o),_=N(()=>o.modelValue||o.defaultValue);return F($,f=>{d("update:model-value",f==="datatable"?{columns:[{name:"",type:"text"}],rows:[[{}]]}:"")}),(f,h)=>(a(),r(k,null,[C($)==="text"?(a(),r("input",{key:0,type:"text",class:"input w-full",value:_.value,onInput:h[0]||(h[0]=g=>p(g)),placeholder:f.$t("components.placeholders.defaultValue")},null,40,mt)):M("",!0),C($)==="textarea"?(a(),r("textarea",{key:1,class:"input w-full",onInput:h[1]||(h[1]=g=>p(g)),placeholder:f.$t("components.placeholders.defaultValue")},v(_.value),41,pt)):C($)==="resource"?(a(),E(Ae,{key:2,modelValue:_.value,"onUpdate:modelValue":h[2]||(h[2]=g=>i(g))},null,8,["modelValue"])):C($)==="datatable"?(a(),E(Ze,{key:3,editStructure:l.editStructure,name:l.name,modelValue:_.value,"onUpdate:modelValue":h[3]||(h[3]=g=>c(g))},null,8,["editStructure","name","modelValue"])):C($)==="datasource"?(a(),E(lt,{key:4,name:l.name,modelValue:_.value,"onUpdate:modelValue":h[4]||(h[4]=g=>n(g))},null,8,["name","modelValue"])):C($)==="action"?(a(),E(ut,{key:5,name:l.name,modelValue:_.value,"onUpdate:modelValue":h[5]||(h[5]=g=>D(g))},null,8,["name","modelValue"])):C($)==="page"?(a(),E(it,{key:6,name:l.name,modelValue:_.value,"onUpdate:modelValue":h[6]||(h[6]=g=>D(g))},null,8,["name","modelValue"])):M("",!0)],64))}}),bt=(l,y)=>{window.localStorage.setItem(l,y)},wt=(l,y)=>{const o=window.localStorage.getItem(l)||y;return o==="true"?!0:o==="false"?!1:o};export{Re as _,vt as a,_e as b,wt as g,bt as p,he as u};
