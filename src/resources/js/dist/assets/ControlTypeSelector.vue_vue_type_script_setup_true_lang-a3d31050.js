import{e as S,b as E,d as q,o as t,c as a,h as e,t as f,f as L,r as I,a as w,w as A,y as G,j as H,z as J,G as K,F as C,i as j,g as Q,l as M,n as k,C as W,D as X,k as D}from"./index-10cf6b0e.js";import{_ as z}from"./Modal.vue_vue_type_script_setup_true_lang-e8dd8d97.js";import{u as Y}from"./ResourceService-371d19a0.js";import{R as T}from"./ResourcePreview-c9694dab.js";import{v as Z}from"./helpers-66e66eca.js";const B=S([]),ee=async()=>await E.get("source"),te=async()=>{const r=await ee();B.value=r.data.data},oe=()=>({sources:B,loadSources:te}),O=S([]),le=async()=>await E.get("action"),ae=async()=>{const r=await le();O.value=r.data.data},se=()=>({actions:O,loadActions:ae}),ne=["value"],ue={value:"text"},re={value:"textarea"},ce={value:"resource"},de={value:"datatable"},ie={value:"datasource"},me={value:"action"},pe=q({__name:"VariableTypeSelector",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(r){const _=o=>o.target.value;return(o,n)=>(t(),a("select",{class:"input",value:r.modelValue,onChange:n[0]||(n[0]=p=>o.$emit("update:modelValue",_(p)))},[e("option",ue,f(o.$t("components.types.text")),1),e("option",re,f(o.$t("components.types.textarea")),1),e("option",ce,f(o.$t("components.types.resource")),1),e("option",de,f(o.$t("components.types.datatable")),1),e("option",ie,f(o.$t("components.types.datasource")),1),e("option",me,f(o.$t("components.types.action")),1)],40,ne))}}),ve={class:"w-full flex items-center justify-center max-h-full"},fe={class:"absolute top-1/4 bg-teal-500 rounded-lg text-white text-xs p-1 bg-opacity-50"},he={class:"flex justify-between mb-4"},ye=["placeholder"],Ve={class:"grid grid-cols-3 gap-2 overflow-y-auto max-h-[70vh]"},_e=["onClick"],$e=q({__name:"ResourcePicker",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(r,{emit:_}){const o=r,n=S(!1),p=S(""),s=S(!1),{resources:u,loadResources:h,resourceFromId:U}=Y(),$=L(()=>u.value.filter(V=>V.name.toLowerCase().includes(p.value.toLowerCase()))),b=L(()=>{if(!(o.modelValue===void 0||o.modelValue===null))return U(+o.modelValue)}),i=_,m=()=>{n.value=!0},v=V=>{i("update:modelValue",V),n.value=!1},N=()=>{s.value=!0,h().finally(()=>{s.value=!1})};return(V,x)=>{var d;const l=I("fa-icon");return t(),a(C,null,[e("button",{onClick:m,type:"button",class:"button secondary flex gap-2 w-full flex-col justify-start !p-1 relative items-center"},[e("div",ve,[w(T,{url:(d=b.value)==null?void 0:d.url},null,8,["url"])]),e("span",fe,f(b.value?V.$t("components.buttons.changeResource"):V.$t("components.buttons.selectResource")),1)]),w(z,{title:V.$t("components.titles.selectResource"),showModal:n.value,"onUpdate:showModal":x[1]||(x[1]=c=>n.value=c),showCancel:!1,confirmLabel:V.$t("buttons.close")},{default:A(()=>[e("div",he,[e("button",{type:"button",onClick:N,class:"button secondary"},[w(l,{icon:"sync",class:G({"animate-spin":s.value})},null,8,["class"]),H(" "+f(V.$t("resources.buttons.refresh")),1)]),J(e("input",{type:"search","onUpdate:modelValue":x[0]||(x[0]=c=>p.value=c),class:"input",placeholder:V.$t("placeholders.search")},null,8,ye),[[K,p.value]])]),e("div",Ve,[(t(!0),a(C,null,j($.value,c=>(t(),a("button",{type:"button",onClick:y=>v(c.id),class:"button primary flex flex-col gap-2 justify-center items-center"},[w(T,{url:c.url},null,8,["url"]),e("span",null,f(c.name),1)],8,_e))),256))])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),be={class:"overflow-y-auto h-[70vh]"},ge={class:"w-full relative"},we={class:"sticky top-0 z-10"},Ce={class:"flex"},ke={class:"w-full form-group"},Se=["value","onInput","placeholder"],Re=["onClick"],xe={class:"sticky top-0 z-10"},Me={class:"flex justify-center"},je={class:"flex"},qe={class:"flex flex-col gap-1"},Ue=["onClick"],De=q({__name:"DataTable",props:{modelValue:{type:[Object,String,Number,void 0],required:!0},name:{type:String,required:!1}},emits:["update:modelValue"],setup(r,{emit:_}){const o=r,n=({type:l,name:d}={type:"text",name:""})=>({name:d,type:l,value:"",default:""}),p=(l="text")=>({name:"",type:l}),s=S([p()]),u=S([[n()]]),h=S(!1),U=_,$=()=>{h.value=!0},b=()=>{U("update:modelValue",{columns:s.value,rows:u.value}),h.value=!1},i=(l,d,c)=>{d.type=c,u.value.forEach(y=>{y[l].type=d.type})},m=(l,d,c)=>{d.name=Z(c),u.value.forEach(y=>{y[l].name=d.name})},v=()=>{s.value.push(p()),u.value.forEach(l=>{l.push(n())})},N=()=>{const l=[];s.value.forEach(({type:d,name:c})=>{l.push(n({type:d,name:c}))}),u.value.push(l)},V=l=>{s.value.splice(l,1),u.value.forEach(d=>{d.splice(l,1)})},x=l=>{u.value.splice(l,1)};return Q(()=>{o.modelValue&&typeof o.modelValue=="object"&&(s.value=o.modelValue.columns,u.value=o.modelValue.rows)}),(l,d)=>{const c=I("fa-icon");return t(),a(C,null,[e("button",{onClick:$,type:"button",class:"button secondary flex items-center justify-center gap-2 w-full"},[e("span",null,f(l.$t("components.buttons.fillData")),1)]),w(z,{title:l.$t("components.titles.fillData"),showModal:h.value,"onUpdate:showModal":d[0]||(d[0]=y=>h.value=y),showCancel:!1,confirmLabel:l.$t("buttons.close"),resetOnClose:!1,onConfirm:b},{default:A(()=>[e("div",be,[e("table",ge,[e("thead",null,[e("tr",null,[(t(!0),a(C,null,j(s.value,(y,R)=>(t(),a("th",we,[e("div",Ce,[e("div",ke,[e("input",{class:"input",type:"text",value:y.name,onInput:g=>m(R,y,g.target),placeholder:l.$t("components.placeholders.dataName")},null,40,Se),w(pe,{class:"w-5",modelValue:y.type,"onUpdate:modelValue":g=>i(R,y,g)},null,8,["modelValue","onUpdate:modelValue"]),s.value.length>1?(t(),a("button",{key:0,type:"button",class:"button danger",onClick:g=>V(R)},[w(c,{icon:"minus"})],8,Re)):M("",!0)])])]))),256)),e("th",xe,[e("div",Me,[s.value.length>=1?(t(),a("button",{key:0,type:"button",class:"button primary",onClick:v},[w(c,{icon:"plus"})])):M("",!0)])])])]),e("tbody",null,[(t(!0),a(C,null,j(u.value,(y,R)=>(t(),a("tr",{key:`${R}:${r.name}`},[(t(!0),a(C,null,j(y,(g,F)=>(t(),a("td",{key:`${r.name}:${s.value[F].name}:${g.name}`},[e("div",je,[w(Pe,{modelValue:g.default,"onUpdate:modelValue":P=>g.default=P,name:g.name,type:g.type},null,8,["modelValue","onUpdate:modelValue","name","type"])])]))),128)),e("td",null,[e("div",qe,[u.value.length>1?(t(),a("button",{key:0,type:"button",class:"button danger",onClick:g=>x(R)},[w(c,{icon:"minus"})],8,Ue)):M("",!0),R==u.value.length-1?(t(),a("button",{key:1,type:"button",class:"button secondary",onClick:N},[w(c,{icon:"plus"})])):M("",!0)])])]))),128))])])])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),Ne=["value"],Le={value:""},Te=["value"],Ee=q({__name:"DataSource",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:modelValue"],setup(r,{emit:_}){const{sources:o}=oe(),n=_,p=s=>{const u=s.target;n("update:modelValue",u.value)};return(s,u)=>(t(),a("select",{class:"input w-full",onChange:p,value:r.modelValue},[e("option",Le,f(s.$t("placeholders.select")),1),(t(!0),a(C,null,j(k(o),h=>(t(),a("option",{value:h.name},f(h.name),9,Te))),256))],40,Ne))}}),Ie=["value"],Ae={value:""},ze=["value"],Be=q({__name:"Action",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:modelValue"],setup(r,{emit:_}){const{actions:o}=se(),n=_,p=s=>{const u=s.target;n("update:modelValue",u.value)};return(s,u)=>(t(),a("select",{class:"input w-full",onChange:p,value:r.modelValue},[e("option",Ae,f(s.$t("placeholders.select")),1),(t(!0),a(C,null,j(k(o),h=>(t(),a("option",{value:h.name},f(h.name),9,ze))),256))],40,Ie))}}),Oe=["value","placeholder"],Fe=["placeholder"],Pe=q({__name:"ControlTypeSelector",props:{type:{type:String,required:!0},modelValue:{type:[String,Number,Object,null,void 0],required:!0},name:{type:String,required:!0},defaultValue:{type:[String,Number,Object,null,void 0]},class:{type:String}},emits:["update:modelValue"],setup(r,{emit:_}){const o=r,n=_,p=i=>{n("update:modelValue",i.target.value)},s=i=>{n("update:modelValue",i)},u=i=>{n("update:modelValue",i)},h=i=>{n("update:modelValue",i)},U=i=>{n("update:modelValue",i)},{type:$}=W(o),b=L(()=>o.modelValue||o.defaultValue);return X($,()=>{n("update:modelValue","")}),(i,m)=>(t(),a(C,null,[k($)==="text"?(t(),a("input",{key:0,type:"text",class:"input w-full",value:b.value,onInput:m[0]||(m[0]=v=>p(v)),placeholder:i.$t("components.placeholders.defaultValue")},null,40,Oe)):M("",!0),k($)==="textarea"?(t(),a("textarea",{key:1,class:"input w-full",onInput:m[1]||(m[1]=v=>p(v)),placeholder:i.$t("components.placeholders.defaultValue")},f(b.value),41,Fe)):k($)==="resource"?(t(),D($e,{key:2,modelValue:b.value,"onUpdate:modelValue":m[2]||(m[2]=v=>s(v))},null,8,["modelValue"])):k($)==="datatable"?(t(),D(De,{key:3,name:r.name,modelValue:b.value,"onUpdate:modelValue":m[3]||(m[3]=v=>u(v))},null,8,["name","modelValue"])):k($)==="datasource"?(t(),D(Ee,{key:4,name:r.name,modelValue:b.value,"onUpdate:modelValue":m[4]||(m[4]=v=>h(v))},null,8,["name","modelValue"])):k($)==="action"?(t(),D(Be,{key:5,name:r.name,modelValue:b.value,"onUpdate:modelValue":m[5]||(m[5]=v=>U(v))},null,8,["name","modelValue"])):M("",!0)],64))}});export{pe as _,Pe as a,se as b,oe as u};
