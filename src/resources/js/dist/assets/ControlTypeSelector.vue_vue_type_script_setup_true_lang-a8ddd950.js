import{e as S,b as E,d as U,o,c as s,h as e,t as f,f as N,r as I,a as w,w as A,y as H,j as J,z as K,G as Q,F as C,i as q,g as W,D as z,l as M,n as k,C as X,k as D}from"./index-9b95839d.js";import{_ as B}from"./Modal.vue_vue_type_script_setup_true_lang-e7489a4d.js";import{u as Y}from"./ResourceService-e66deb76.js";import{R as T}from"./ResourcePreview-e9009b8e.js";import{v as Z}from"./helpers-66e66eca.js";const F=S([]),ee=async()=>await E.get("source"),te=async()=>{const r=await ee();F.value=r.data.data},oe=()=>({sources:F,loadSources:te}),O=S([]),le=async()=>await E.get("action"),ae=async()=>{const r=await le();O.value=r.data.data},se=()=>({actions:O,loadActions:ae}),ne=["value"],ue={value:"text"},re={value:"textarea"},ce={value:"resource"},de={value:"datatable"},ie={value:"datasource"},me={value:"action"},pe=U({__name:"VariableTypeSelector",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(r){const V=l=>l.target.value;return(l,n)=>(o(),s("select",{class:"input",value:r.modelValue,onChange:n[0]||(n[0]=p=>l.$emit("update:modelValue",V(p)))},[e("option",ue,f(l.$t("components.types.text")),1),e("option",re,f(l.$t("components.types.textarea")),1),e("option",ce,f(l.$t("components.types.resource")),1),e("option",de,f(l.$t("components.types.datatable")),1),e("option",ie,f(l.$t("components.types.datasource")),1),e("option",me,f(l.$t("components.types.action")),1)],40,ne))}}),ve={class:"w-full flex items-center justify-center max-h-full"},fe={class:"absolute top-1/4 bg-teal-500 rounded-lg text-white text-xs p-1 bg-opacity-50"},he={class:"flex justify-between mb-4"},ye=["placeholder"],_e={class:"grid grid-cols-3 gap-2 overflow-y-auto max-h-[70vh]"},Ve=["onClick"],$e=U({__name:"ResourcePicker",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(r,{emit:V}){const l=r,n=S(!1),p=S(""),a=S(!1),{resources:u,loadResources:h,resourceFromId:j}=Y(),$=N(()=>u.value.filter(_=>_.name.toLowerCase().includes(p.value.toLowerCase()))),b=N(()=>{if(!(l.modelValue===void 0||l.modelValue===null))return j(+l.modelValue)}),i=V,m=()=>{n.value=!0},v=_=>{i("update:modelValue",_),n.value=!1},L=()=>{a.value=!0,h().finally(()=>{a.value=!1})};return(_,x)=>{var c;const t=I("fa-icon");return o(),s(C,null,[e("button",{onClick:m,type:"button",class:"button secondary flex gap-2 w-full flex-col justify-start !p-1 relative items-center"},[e("div",ve,[w(T,{url:(c=b.value)==null?void 0:c.url},null,8,["url"])]),e("span",fe,f(b.value?_.$t("components.buttons.changeResource"):_.$t("components.buttons.selectResource")),1)]),w(B,{title:_.$t("components.titles.selectResource"),showModal:n.value,"onUpdate:showModal":x[1]||(x[1]=d=>n.value=d),showCancel:!1,confirmLabel:_.$t("buttons.close")},{default:A(()=>[e("div",he,[e("button",{type:"button",onClick:L,class:"button secondary"},[w(t,{icon:"sync",class:H({"animate-spin":a.value})},null,8,["class"]),J(" "+f(_.$t("resources.buttons.refresh")),1)]),K(e("input",{type:"search","onUpdate:modelValue":x[0]||(x[0]=d=>p.value=d),class:"input",placeholder:_.$t("placeholders.search")},null,8,ye),[[Q,p.value]])]),e("div",_e,[(o(!0),s(C,null,q($.value,d=>(o(),s("button",{type:"button",onClick:y=>v(d.id),class:"button primary flex flex-col gap-2 justify-center items-center"},[w(T,{url:d.url},null,8,["url"]),e("span",null,f(d.name),1)],8,Ve))),256))])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),be={class:"overflow-y-auto h-[70vh]"},ge={class:"w-full relative"},we={class:"sticky top-0 z-10"},Ce={class:"flex"},ke={class:"w-full form-group"},Se=["value","onInput","placeholder"],Re=["onClick"],xe={class:"sticky top-0 z-10"},Me={class:"flex justify-center"},qe={class:"flex"},Ue={class:"flex flex-col gap-1"},je=["onClick"],De=U({__name:"DataTable",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(r,{emit:V}){const l=r,n=({type:t,name:c}={type:"text",name:""})=>({name:c,type:t,value:"",default:""}),p=(t="text")=>({name:"",type:t}),a=S([p()]),u=S([[n()]]),h=S(!1),j=V,$=()=>{h.value=!0},b=()=>{j("update:model-value",{columns:a.value,rows:u.value}),h.value=!1},i=(t,c,d)=>{c.type=d,u.value.forEach(y=>{y[t].type=c.type})},m=(t,c,d)=>{c.name=Z(d),u.value.forEach(y=>{y[t].name=c.name})},v=()=>{a.value.push(p()),u.value.forEach(t=>{t.push(n())})},L=()=>{const t=[];a.value.forEach(({type:c,name:d})=>{t.push(n({type:c,name:d}))}),u.value.push(t)},_=t=>{a.value.splice(t,1),u.value.forEach(c=>{c.splice(t,1)})},x=t=>{u.value.splice(t,1)};return W(()=>{if(l.modelValue&&typeof l.modelValue=="object"){const t=l.modelValue;a.value=t.columns,u.value=t.rows}}),z(()=>l.modelValue,t=>{if(t&&typeof t=="object"){const c=l.modelValue;a.value=c.columns,u.value=c.rows}}),(t,c)=>{const d=I("fa-icon");return o(),s(C,null,[e("button",{onClick:$,type:"button",class:"button secondary flex items-center justify-center gap-2 w-full"},[e("span",null,f(t.$t("components.buttons.fillData")),1)]),w(B,{title:t.$t("components.titles.fillData"),showModal:h.value,"onUpdate:showModal":c[0]||(c[0]=y=>h.value=y),showCancel:!1,confirmLabel:t.$t("buttons.close"),resetOnClose:!1,onConfirm:b},{default:A(()=>[e("div",be,[e("table",ge,[e("thead",null,[e("tr",null,[(o(!0),s(C,null,q(a.value,(y,R)=>(o(),s("th",we,[e("div",Ce,[e("div",ke,[e("input",{class:"input",type:"text",value:y.name,onInput:g=>m(R,y,g.target),placeholder:t.$t("components.placeholders.dataName")},null,40,Se),w(pe,{class:"w-5",modelValue:y.type,"onUpdate:modelValue":g=>i(R,y,g)},null,8,["modelValue","onUpdate:modelValue"]),a.value.length>1?(o(),s("button",{key:0,type:"button",class:"button danger",onClick:g=>_(R)},[w(d,{icon:"minus"})],8,Re)):M("",!0)])])]))),256)),e("th",xe,[e("div",Me,[a.value.length>=1?(o(),s("button",{key:0,type:"button",class:"button primary",onClick:v},[w(d,{icon:"plus"})])):M("",!0)])])])]),e("tbody",null,[(o(!0),s(C,null,q(u.value,(y,R)=>(o(),s("tr",{key:`${R}:${r.name}`},[(o(!0),s(C,null,q(y,(g,P)=>(o(),s("td",{key:`${r.name}:${a.value[P].name}:${g.name}`},[e("div",qe,[w(Pe,{modelValue:g.default,"onUpdate:modelValue":G=>g.default=G,name:g.name,type:g.type},null,8,["modelValue","onUpdate:modelValue","name","type"])])]))),128)),e("td",null,[e("div",Ue,[u.value.length>1?(o(),s("button",{key:0,type:"button",class:"button danger",onClick:g=>x(R)},[w(d,{icon:"minus"})],8,je)):M("",!0),R==u.value.length-1?(o(),s("button",{key:1,type:"button",class:"button secondary",onClick:L},[w(d,{icon:"plus"})])):M("",!0)])])]))),128))])])])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),Le=["value"],Ne={value:""},Te=["value"],Ee=U({__name:"DataSource",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(r,{emit:V}){const{sources:l}=oe(),n=V,p=a=>{const u=a.target;n("update:model-value",u.value)};return(a,u)=>(o(),s("select",{class:"input w-full",onChange:p,value:r.modelValue},[e("option",Ne,f(a.$t("placeholders.select")),1),(o(!0),s(C,null,q(k(l),h=>(o(),s("option",{value:h.name},f(h.name),9,Te))),256))],40,Le))}}),Ie=["value"],Ae={value:""},ze=["value"],Be=U({__name:"Action",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(r,{emit:V}){const{actions:l}=se(),n=V,p=a=>{const u=a.target;n("update:model-value",u.value)};return(a,u)=>(o(),s("select",{class:"input w-full",onChange:p,value:r.modelValue},[e("option",Ae,f(a.$t("placeholders.select")),1),(o(!0),s(C,null,q(k(l),h=>(o(),s("option",{value:h.name},f(h.name),9,ze))),256))],40,Ie))}}),Fe=["value","placeholder"],Oe=["placeholder"],Pe=U({__name:"ControlTypeSelector",props:{type:{type:String,required:!0},modelValue:{required:!0},name:{type:String,required:!0},defaultValue:{type:[String,Number,Object,null,void 0]},class:{type:String}},emits:["update:model-value"],setup(r,{emit:V}){const l=r,n=V,p=i=>{n("update:model-value",i.target.value)},a=i=>{n("update:model-value",i)},u=i=>{n("update:model-value",i)},h=i=>{n("update:model-value",i)},j=i=>{n("update:model-value",i)},{type:$}=X(l),b=N(()=>l.modelValue||l.defaultValue);return z($,()=>{n("update:model-value","")}),(i,m)=>(o(),s(C,null,[k($)==="text"?(o(),s("input",{key:0,type:"text",class:"input w-full",value:b.value,onInput:m[0]||(m[0]=v=>p(v)),placeholder:i.$t("components.placeholders.defaultValue")},null,40,Fe)):M("",!0),k($)==="textarea"?(o(),s("textarea",{key:1,class:"input w-full",onInput:m[1]||(m[1]=v=>p(v)),placeholder:i.$t("components.placeholders.defaultValue")},f(b.value),41,Oe)):k($)==="resource"?(o(),D($e,{key:2,modelValue:b.value,"onUpdate:modelValue":m[2]||(m[2]=v=>a(v))},null,8,["modelValue"])):k($)==="datatable"?(o(),D(De,{key:3,name:r.name,modelValue:b.value,"onUpdate:modelValue":m[3]||(m[3]=v=>u(v))},null,8,["name","modelValue"])):k($)==="datasource"?(o(),D(Ee,{key:4,name:r.name,modelValue:b.value,"onUpdate:modelValue":m[4]||(m[4]=v=>h(v))},null,8,["name","modelValue"])):k($)==="action"?(o(),D(Be,{key:5,name:r.name,modelValue:b.value,"onUpdate:modelValue":m[5]||(m[5]=v=>j(v))},null,8,["name","modelValue"])):M("",!0)],64))}});export{pe as _,Pe as a,se as b,oe as u};
