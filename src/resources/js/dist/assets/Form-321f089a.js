import{v as A,i as te}from"./helpers-6321440c.js";import{d as F,e as O,r as V,c as v,g as t,E as y,D as oe,a as m,i as P,t as c,o as u,_ as L,b as S,j as T,w,k,p as I,f as J,F as E,h as ne,m as se,G as ie,H as ae,I as le,J as ce,q as R,K as H}from"./index-cc6630f0.js";import{D as z}from"./vuedraggable.umd-7961fdc7.js";import{g as re,b as ue}from"./ComponentService-2e36635b.js";import{a as de}from"./ControlTypeSelector.vue_vue_type_script_setup_true_lang-d9a85194.js";import{u as G}from"./ResourceService-dbae8662.js";import{b as pe}from"./PageService-bebb8166.js";const me=F({__name:"FloatToolbar",props:{position:{type:String,default:"top"},isInvisible:{type:Boolean,default:!1},showLabel:{type:String},hiddeLabel:{type:String}},emits:["update:isInvisible"],setup(e){const a=e,i=O(()=>`position-${a.position}-0`),o=O(()=>{switch(a.position){case"left":return"position-left";case"right":return"position-right";case"top":return"position-top";case"bottom":return"position-bottom"}});return(l,d)=>{const n=V("fa-icon");return u(),v("div",{class:y(["float-toolbar",o.value,i.value,{"float-toolbar-top":e.position==="top","float-toolbar-right":["left","right"].includes(e.position)}])},[t("div",{class:y(["float-toolbar-container",{"float-toolbar-container-vertical":["top","bottom"].includes(e.position)}])},[t("div",{class:y(["float-toolbar-accordion",{"float-toolbar-accordion-contracted":e.isInvisible,"float-toolbar-accordion-contracted-vertical":e.isInvisible&&["top","bottom"].includes(e.position),"float-toolbar-accordion-contracted-horizontal ":e.isInvisible&&["left","right"].includes(e.position)}])},[t("div",{class:y(["float-toolbar-content",{"rounded-top":e.position==="top","rounded-bottom":e.position==="bottom","rounded-left":e.position==="left","rounded-right":e.position==="right"}])},[oe(l.$slots,"default",{},void 0,!0)],2)],2),t("div",{class:y(["float-toolbar-buttons",{"float-toolbar-buttons-vertical":e.position==="top","float-toolbar-buttons-horizontal":["left","right"].includes(e.position),left:e.position==="left",right:e.position==="right"}])},[t("button",{class:y(["float-toolbar-button",{"vertical-mode":["left","right"].includes(e.position)}]),type:"button",onClick:d[0]||(d[0]=$=>l.$emit("update:isInvisible",!e.isInvisible))},[m(n,{icon:e.isInvisible?"eye":"eye-slash"},null,8,["icon"]),P(" "+c(e.isInvisible?e.showLabel||l.$t("buttons.show"):e.hiddeLabel||l.$t("buttons.hide")),1)],2)],2)],2)],2)}}});const K=L(me,[["__scopeId","data-v-3d3dec55"]]),ge={class:"toolbar-container"},be={class:"toolbar-actions"},ve={type:"submit",class:"button-link"},fe={class:"title"},he=["href"],_e={class:"toolbar-route"},$e={class:"toolbar-route-input"},ye={class:"label"},ke=["value","placeholder"],Ce={class:"toolbar-route-input"},Se={class:"label"},we=["value","placeholder"],Te={class:"toolbar-route-input"},Ie={class:"label"},Ve=["value","placeholder"],Fe=F({__name:"PageToolbar",props:{showDelete:Boolean,title:String,name:{type:String,default:""},url:{type:String,default:""},pageTitle:{type:String,default:""},pageEditionMode:{type:String,default:"adding-component"}},emits:["delete","update:name","update:pageTitle","update:url"],setup(e){const a=S(!0);return(i,o)=>{const l=V("fa-icon"),d=V("router-link");return u(),T(K,{isInvisible:a.value,"onUpdate:isInvisible":o[4]||(o[4]=n=>a.value=n),showLabel:i.$t("pages.buttons.settings")},{default:w(()=>[t("div",ge,[t("div",be,[m(d,{class:"button-link",to:{name:"pages.index"}},{default:w(()=>[m(l,{icon:"arrow-left"}),P(" "+c(i.$t("buttons.back")),1)]),_:1},8,["to"]),e.showDelete?(u(),v("button",{key:0,onClick:o[0]||(o[0]=n=>i.$emit("delete")),type:"button",class:"button-link danger"},c(i.$t("buttons.delete")),1)):k("",!0),t("button",ve,c(i.$t("buttons.save")),1),t("h1",fe,[P(c(e.title)+" ",1),e.showDelete?(u(),v("a",{key:0,href:e.url,target:"_blank"},[m(l,{icon:"external-link-alt"})],8,he)):k("",!0)])]),t("div",_e,[t("div",$e,[t("label",ye,c(i.$t("pages.labels.pageName")),1),t("input",{class:"input",type:"text",required:"",value:e.name,onInput:o[1]||(o[1]=n=>i.$emit("update:name",I(A)(n.target))),placeholder:i.$t("pages.placeholders.pageName")},null,40,ke)]),t("div",Ce,[t("label",Se,c(i.$t("pages.labels.pageTitle")),1),t("input",{class:"input",type:"text",value:e.pageTitle,onInput:o[2]||(o[2]=n=>i.$emit("update:pageTitle",I(te)(n.target))),placeholder:i.$t("pages.placeholders.pageTitle")},null,40,we)]),t("div",Te,[t("label",Ie,c(i.$t("pages.labels.pageUrl")),1),t("input",{class:"input",type:"text",value:e.url,onInput:o[3]||(o[3]=n=>i.$emit("update:url",I(A)(n.target))),placeholder:i.$t("pages.placeholders.pageUrl")},null,40,Ve)])])])]),_:1},8,["isInvisible","showLabel"])}}});const vt=L(Fe,[["__scopeId","data-v-e5b92884"]]),Ue={class:"font-bold"},De={class:"tile h-24 cursor-pointer"},Pe={class:"tile-title cursor-pointer"},Le=F({__name:"AvailableComponents",setup(e){const a=S([]),i=o=>{const l={};o.variables.forEach(n=>{l[n.name]=null});const d={id:o.id||1+1,...o,variables:o.variables.map(n=>({...n})),content:l};return delete d.content_id,d};return J(()=>{re().then(o=>{a.value=o.data.data})}),(o,l)=>(u(),v(E,null,[t("h2",Ue,c(o.$t("pages.titles.availableComponents")),1),m(I(z),{class:"grid grid-cols-2 gap-4",modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=d=>a.value=d),group:{name:"components",pull:"clone",put:!1},sort:!1,clone:i,"item-key":"id"},{item:w(({element:d})=>[t("div",De,[t("label",Pe,c(d.name),1)])]),_:1},8,["modelValue"])],64))}}),Be={class:"form-group"},Ee={key:0,class:"component-configuration-parameters"},Me={class:"component-configuration-label"},Ne=F({__name:"ComponentConfigurationForm",props:{component:{type:Object},position:{type:String,default:"left"}},emits:["exit","update:position"],setup(e,{emit:a}){const i=e,o=a,l=()=>{const n=i.position==="left"?"right":"left";o("update:position",n)},d=(n,$)=>{n.content&&(n.content[$]=null)};return(n,$)=>{const C=V("fa-icon");return u(),v(E,null,[t("div",{class:y(`component-configuration-title ${e.position}`)},[t("h2",null,c(n.$t("pages.titles.componentConfigurationForm")),1),t("div",null,[t("div",Be,[t("button",{type:"button",class:"button small default",onClick:$[0]||($[0]=f=>n.$emit("exit"))},c(n.$t("pages.buttons.exit")),1),t("button",{type:"button",class:"button small default button-position",onClick:l},[m(C,{icon:"border-top-left"})])])])],2),e.component?(u(),v("div",Ee,[(u(!0),v(E,null,ne(e.component.variables,f=>(u(),v("div",{key:f.name},[t("div",Me,[t("label",null,c(f.name)+":",1),m(C,{class:"component-configuration-set-default",icon:"arrows-rotate",onClick:B=>d(e.component,f.name)},null,8,["onClick"])]),e.component.content?(u(),T(de,{key:0,modelValue:e.component.content[f.name],"onUpdate:modelValue":B=>e.component.content[f.name]=B,"default-value":f.default,name:f.name,type:f.type},null,8,["modelValue","onUpdate:modelValue","default-value","name","type"])):k("",!0)]))),128))])):k("",!0)],64)}}});const ze=L(Ne,[["__scopeId","data-v-2c350eb3"]]),Ae=e=>(ie("data-v-e8ede51d"),e=e(),ae(),e),Oe=Ae(()=>t("hr",null,null,-1)),Re=F({__name:"PageSectionButtonAdd",emits:["click"],setup(e){return(a,i)=>{const o=V("fa-icon");return u(),v("button",{class:"page-sections-buttons-add",onClick:i[0]||(i[0]=se(l=>a.$emit("click"),["stop"])),type:"button"},[Oe,t("span",null,[m(o,{icon:"square-plus"}),P(" "+c(a.$t("pages.buttons.addSection")),1)])])}}});const q=L(Re,[["__scopeId","data-v-e8ede51d"]]),{resourceFromId:He}=G(),j=e=>typeof e=="string"?e:"",qe=e=>(typeof e=="number"||typeof e=="string")&&He(+e).url||"",je=(e,a)=>{switch(e){case"text":return j(a);case"resource":return qe(a);case"datatable":return a;case"textarea":return j(a)}},Je={class:"component-wizard"},Ge={class:"page-sections-container"},Ke={class:"page-sections-content"},Qe={class:"page-sections-item-panel"},We={class:"page-sections-preview"},Xe=["innerHTML"],Ye={class:"page-sections-item-buttons"},Ze={class:"page-sections-components-grip-lines"},xe={class:"pages-secttions-component-buttons"},et=["onClick"],tt=["onClick"],ot={class:"page-sections-label"},nt={class:"hideable-header"},st={class:"page-sections-buttons"},it={key:1},at={key:2},lt=["onClick"],ct=F({__name:"Form",props:{sections:{type:Array,default:()=>[{order:0,components:[]},{order:0,components:[]}]}},emits:["update:sections"],setup(e,{emit:a}){const{loadResources:i}=G(),o=e,l=S(!0),d=a,n=S(null),$=S(null),C=S("adding-component"),f=s=>{const r=[...o.sections];r.splice(s,0,H({order:0,components:[]})),d("update:sections",r)},B=()=>{d("update:sections",[...o.sections,H({order:0,components:[]})])},Q=s=>{const r=[...o.sections];r.splice(s,1),d("update:sections",r)},W=(s,r)=>{s.splice(r,1)},X=(s,r)=>{l.value=!1,C.value="editing-component",n.value=s,$.value=r},Y=()=>{l.value=!0,C.value="adding-component",n.value=null,$.value=null},Z=s=>(s.content=s.content||ue(s),s.variables.reduce((h,_)=>{var D;const g=s.content&&s.content[_.name]?s.content[_.name]:(D=s.variables.find(N=>N.name===_.name))==null?void 0:D.default,p=g?je(_.type,g==null?void 0:g.toString()):"";let b="";return typeof p=="string"?b=p:b=JSON.stringify(p),h.replace(`{{ $${_.name} }}`,b||"")},s.html)),x=(s,r)=>{var h,_;return((h=n.value)==null?void 0:h.id)===s.id&&s.order===((_=n.value)==null?void 0:_.order)&&$.value===r},U=document.createElement("link"),ee=()=>{const s=pe("style");U.rel="stylesheet",U.href=s,document.head.appendChild(U)},M=S("left");return J(()=>{i(),ee()}),le(()=>{U&&document.head.removeChild(U)}),(s,r)=>{const h=V("fa-icon"),_=ce("autosize");return u(),v(E,null,[m(K,{isInvisible:l.value,"onUpdate:isInvisible":r[1]||(r[1]=g=>l.value=g),position:M.value,showLabel:s.$t("pages.buttons.components")},{default:w(()=>[t("div",Je,[C.value==="adding-component"?(u(),T(Le,{key:0})):k("",!0),C.value==="editing-component"?(u(),T(ze,{key:1,position:M.value,"onUpdate:position":r[0]||(r[0]=g=>M.value=g),component:n.value,onExit:Y},null,8,["position","component"])):k("",!0)])]),_:1},8,["isInvisible","position","showLabel"]),t("div",Ge,[t("div",Ke,[m(I(z),{list:e.sections,class:"page-sections-panel",onInput:r[2]||(r[2]=g=>s.$emit("update:sections",g)),group:"sections","item-key":"id",handle:".page-sections-grip-lines"},{item:w(({element:g,index:p})=>[t("div",{class:y(["page-sections-list-content",{"page-sections-list-header":!p,"page-sections-list-footer":p===e.sections.length-1}])},[p?(u(),T(q,{key:0,onClick:b=>f(p)},null,8,["onClick"])):k("",!0),t("div",Qe,[m(I(z),{class:"page-sections-dreaggable",modelValue:g.components,"onUpdate:modelValue":b=>g.components=b,group:"components","item-key":"id",handle:".page-sections-components-grip-lines"},{item:w(({element:b,index:D})=>[t("div",{class:y(["page-sections-item",{"page-sections-item-selected":x(b,p)}])},[R((u(),v("div",We,[R(t("div",{class:"page-sections-preview-content",innerHTML:Z(b)},null,8,Xe),[[_]]),t("div",Ye,[t("button",Ze,[m(h,{icon:"grip"})]),t("div",xe,[t("button",{type:"button",onClick:N=>W(g.components,D)},[m(h,{icon:"trash"})],8,et),t("button",{type:"button",onClick:N=>X(b,p)},[m(h,{icon:"file-invoice"})],8,tt),t("span",ot,c(s.$t("pages.labels.component"))+" "+c((b.order=D)+1)+" - "+c(b.name),1)])])])),[[_]])],2)]),header:w(()=>[t("div",nt,[t("p",null,c(s.$t("pages.labels.addComponentsToSection",{section:p})),1)])]),_:2},1032,["modelValue","onUpdate:modelValue"]),t("div",st,[p&&p!==e.sections.length-1?(u(),T(h,{key:0,icon:"grip",class:"page-sections-grip-lines"})):k("",!0),p?(u(),v("span",at,c(s.$t(p===e.sections.length-1?"pages.labels.footer":"pages.labels.section",{section:g.order=p})),1)):(u(),v("span",it,[m(h,{icon:"heading"}),P(" "+c(s.$t("pages.labels.header")),1)])),t("button",{onClick:b=>Q(p)},[m(h,{icon:"trash"})],8,lt)])])],2)]),_:1},8,["list"]),m(q,{onClick:B})])])],64)}}});const ft=L(ct,[["__scopeId","data-v-cf2e0617"]]);export{vt as P,ft as a};
