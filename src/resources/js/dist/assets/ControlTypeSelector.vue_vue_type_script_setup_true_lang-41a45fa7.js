import{e as S,b as B,d as U,o,c as s,h as e,t as f,f as N,r as E,a as w,w as I,y as H,j as J,z as K,G as Q,F as C,i as q,g as W,D as A,k as D,l as x,n as k,C as X}from"./index-2a0e0e4b.js";import{_ as z}from"./Modal.vue_vue_type_script_setup_true_lang-1541cbc6.js";import{u as Y}from"./ResourceService-a55a40be.js";import{R as T}from"./ResourcePreview-2b47b041.js";import{v as Z}from"./helpers-66e66eca.js";const F=S([]),ee=async()=>await B.get("source"),te=async()=>{const a=await ee();F.value=a.data.data},oe=()=>({sources:F,loadSources:te}),O=S([]),le=async()=>await B.get("action"),ae=async()=>{const a=await le();O.value=a.data.data},ne=()=>({actions:O,loadActions:ae}),se=["value"],ue={value:"text"},re={value:"textarea"},ce={value:"resource"},de={value:"datatable"},ie={value:"datasource"},me={value:"action"},pe=U({__name:"VariableTypeSelector",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(a){const $=l=>l.target.value;return(l,u)=>(o(),s("select",{class:"input",value:a.modelValue,onChange:u[0]||(u[0]=p=>l.$emit("update:modelValue",$(p)))},[e("option",ue,f(l.$t("components.types.text")),1),e("option",re,f(l.$t("components.types.textarea")),1),e("option",ce,f(l.$t("components.types.resource")),1),e("option",de,f(l.$t("components.types.datatable")),1),e("option",ie,f(l.$t("components.types.datasource")),1),e("option",me,f(l.$t("components.types.action")),1)],40,se))}}),ve={class:"w-full flex items-center justify-center max-h-full"},fe={class:"absolute top-1/4 bg-teal-500 rounded-lg text-white text-xs p-1 bg-opacity-50"},he={class:"flex justify-between mb-4"},ye=["placeholder"],Ve={class:"grid grid-cols-3 gap-2 overflow-y-auto max-h-[70vh]"},$e=["onClick"],_e=U({__name:"ResourcePicker",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(a,{emit:$}){const l=a,u=S(!1),p=S(""),n=S(!1),{resources:r,loadResources:h,resourceFromId:j}=Y(),_=N(()=>r.value.filter(V=>V.name.toLowerCase().includes(p.value.toLowerCase()))),b=N(()=>{if(!(l.modelValue===void 0||l.modelValue===null))return j(+l.modelValue)}),i=$,m=()=>{u.value=!0},v=V=>{i("update:modelValue",V),u.value=!1},L=()=>{n.value=!0,h().finally(()=>{n.value=!1})};return(V,M)=>{var c;const t=E("fa-icon");return o(),s(C,null,[e("button",{onClick:m,type:"button",class:"button secondary flex gap-2 w-full flex-col justify-start !p-1 relative items-center"},[e("div",ve,[w(T,{url:(c=b.value)==null?void 0:c.url},null,8,["url"])]),e("span",fe,f(b.value?V.$t("components.buttons.changeResource"):V.$t("components.buttons.selectResource")),1)]),w(z,{title:V.$t("components.titles.selectResource"),showModal:u.value,"onUpdate:showModal":M[1]||(M[1]=d=>u.value=d),showCancel:!1,confirmLabel:V.$t("buttons.close")},{default:I(()=>[e("div",he,[e("button",{type:"button",onClick:L,class:"button secondary"},[w(t,{icon:"sync",class:H({"animate-spin":n.value})},null,8,["class"]),J(" "+f(V.$t("resources.buttons.refresh")),1)]),K(e("input",{type:"search","onUpdate:modelValue":M[0]||(M[0]=d=>p.value=d),class:"input",placeholder:V.$t("placeholders.search")},null,8,ye),[[Q,p.value]])]),e("div",Ve,[(o(!0),s(C,null,q(_.value,d=>(o(),s("button",{type:"button",onClick:y=>v(d.id),class:"button primary flex flex-col gap-2 justify-center items-center"},[w(T,{url:d.url},null,8,["url"]),e("span",null,f(d.name),1)],8,$e))),256))])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),be={class:"overflow-y-auto h-[70vh]"},ge={class:"w-full relative"},we={class:"sticky top-0 z-10"},Ce={class:"flex"},ke={class:"w-full form-group"},Se=["value","onInput","placeholder","readonly"],Re=["onClick"],xe={class:"sticky top-0 z-10"},Me={class:"flex justify-center"},qe={class:"flex"},Ue={class:"flex flex-col gap-1"},je=["onClick"],De=U({__name:"DataTable",props:{modelValue:{required:!0},name:{type:String,required:!1},editStructure:{type:Boolean,default:!0}},emits:["update:model-value"],setup(a,{emit:$}){const l=a,u=({type:t,name:c}={type:"text",name:""})=>({name:c,type:t,value:"",default:""}),p=(t="text")=>({name:"",type:t}),n=S([p()]),r=S([[u()]]),h=S(!1),j=$,_=()=>{h.value=!0},b=()=>{j("update:model-value",{columns:n.value,rows:r.value}),h.value=!1},i=(t,c,d)=>{c.type=d,r.value.forEach(y=>{y[t].type=c.type})},m=(t,c,d)=>{c.name=Z(d),r.value.forEach(y=>{y[t].name=c.name})},v=()=>{n.value.push(p()),r.value.forEach(t=>{t.push(u())})},L=()=>{const t=[];n.value.forEach(({type:c,name:d})=>{t.push(u({type:c,name:d}))}),r.value.push(t)},V=t=>{n.value.splice(t,1),r.value.forEach(c=>{c.splice(t,1)})},M=t=>{r.value.splice(t,1)};return W(()=>{if(l.modelValue&&typeof l.modelValue=="object"){const t=l.modelValue;n.value=t.columns,r.value=t.rows}}),A(()=>l.modelValue,t=>{if(t&&typeof t=="object"){const c=l.modelValue;n.value=c.columns,r.value=c.rows}}),(t,c)=>{const d=E("fa-icon");return o(),s(C,null,[e("button",{onClick:_,type:"button",class:"button secondary flex items-center justify-center gap-2 w-full"},[e("span",null,f(t.$t("components.buttons.fillData")),1)]),w(z,{title:t.$t("components.titles.fillData"),showModal:h.value,"onUpdate:showModal":c[0]||(c[0]=y=>h.value=y),showCancel:!1,confirmLabel:t.$t("buttons.close"),resetOnClose:!1,onConfirm:b},{default:I(()=>[e("div",be,[e("table",ge,[e("thead",null,[e("tr",null,[(o(!0),s(C,null,q(n.value,(y,R)=>(o(),s("th",we,[e("div",Ce,[e("div",ke,[e("input",{class:"input w-full",type:"text",value:y.name,onInput:g=>m(R,y,g.target),placeholder:t.$t("components.placeholders.dataName"),readonly:!a.editStructure},null,40,Se),a.editStructure?(o(),D(pe,{key:0,class:"w-5",modelValue:y.type,"onUpdate:modelValue":g=>i(R,y,g)},null,8,["modelValue","onUpdate:modelValue"])):x("",!0),n.value.length>1&&a.editStructure?(o(),s("button",{key:1,type:"button",class:"button danger",onClick:g=>V(R)},[w(d,{icon:"minus"})],8,Re)):x("",!0)])])]))),256)),e("th",xe,[e("div",Me,[n.value.length>=1&&a.editStructure?(o(),s("button",{key:0,type:"button",class:"button primary",onClick:v},[w(d,{icon:"plus"})])):x("",!0)])])])]),e("tbody",null,[(o(!0),s(C,null,q(r.value,(y,R)=>(o(),s("tr",{key:`${R}:${a.name}`},[(o(!0),s(C,null,q(y,(g,P)=>(o(),s("td",{key:`${a.name}:${n.value[P].name}:${g.name}`},[e("div",qe,[w(Pe,{modelValue:g.default,"onUpdate:modelValue":G=>g.default=G,name:g.name,type:g.type},null,8,["modelValue","onUpdate:modelValue","name","type"])])]))),128)),e("td",null,[e("div",Ue,[r.value.length>1?(o(),s("button",{key:0,type:"button",class:"button danger",onClick:g=>M(R)},[w(d,{icon:"minus"})],8,je)):x("",!0),R==r.value.length-1?(o(),s("button",{key:1,type:"button",class:"button secondary",onClick:L},[w(d,{icon:"plus"})])):x("",!0)])])]))),128))])])])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),Le=["value"],Ne={value:""},Te=["value"],Be=U({__name:"DataSource",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(a,{emit:$}){const{sources:l}=oe(),u=$,p=n=>{const r=n.target;u("update:model-value",r.value)};return(n,r)=>(o(),s("select",{class:"input w-full",onChange:p,value:a.modelValue},[e("option",Ne,f(n.$t("placeholders.select")),1),(o(!0),s(C,null,q(k(l),h=>(o(),s("option",{value:h.name},f(h.name),9,Te))),256))],40,Le))}}),Ee=["value"],Ie={value:""},Ae=["value"],ze=U({__name:"Action",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(a,{emit:$}){const{actions:l}=ne(),u=$,p=n=>{const r=n.target;u("update:model-value",r.value)};return(n,r)=>(o(),s("select",{class:"input w-full",onChange:p,value:a.modelValue},[e("option",Ie,f(n.$t("placeholders.select")),1),(o(!0),s(C,null,q(k(l),h=>(o(),s("option",{value:h.name},f(h.name),9,Ae))),256))],40,Ee))}}),Fe=["value","placeholder"],Oe=["placeholder"],Pe=U({__name:"ControlTypeSelector",props:{type:{type:String,required:!0},modelValue:{required:!0},name:{type:String,required:!0},defaultValue:{type:[String,Number,Object,null,void 0]},class:{type:String},editStructure:{type:Boolean,default:!0}},emits:["update:model-value"],setup(a,{emit:$}){const l=a,u=$,p=i=>{u("update:model-value",i.target.value)},n=i=>{u("update:model-value",i)},r=i=>{u("update:model-value",i)},h=i=>{u("update:model-value",i)},j=i=>{u("update:model-value",i)},{type:_}=X(l),b=N(()=>l.modelValue||l.defaultValue);return A(_,()=>{u("update:model-value","")}),(i,m)=>(o(),s(C,null,[k(_)==="text"?(o(),s("input",{key:0,type:"text",class:"input w-full",value:b.value,onInput:m[0]||(m[0]=v=>p(v)),placeholder:i.$t("components.placeholders.defaultValue")},null,40,Fe)):x("",!0),k(_)==="textarea"?(o(),s("textarea",{key:1,class:"input w-full",onInput:m[1]||(m[1]=v=>p(v)),placeholder:i.$t("components.placeholders.defaultValue")},f(b.value),41,Oe)):k(_)==="resource"?(o(),D(_e,{key:2,modelValue:b.value,"onUpdate:modelValue":m[2]||(m[2]=v=>n(v))},null,8,["modelValue"])):k(_)==="datatable"?(o(),D(De,{key:3,editStructure:a.editStructure,name:a.name,modelValue:b.value,"onUpdate:modelValue":m[3]||(m[3]=v=>r(v))},null,8,["editStructure","name","modelValue"])):k(_)==="datasource"?(o(),D(Be,{key:4,name:a.name,modelValue:b.value,"onUpdate:modelValue":m[4]||(m[4]=v=>h(v))},null,8,["name","modelValue"])):k(_)==="action"?(o(),D(ze,{key:5,name:a.name,modelValue:b.value,"onUpdate:modelValue":m[5]||(m[5]=v=>j(v))},null,8,["name","modelValue"])):x("",!0)],64))}});export{pe as _,Pe as a,ne as b,oe as u};
