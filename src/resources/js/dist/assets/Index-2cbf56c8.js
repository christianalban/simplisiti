import{b as $,d as x,e as h,u as R,f as E,r as T,o as p,c as v,a as y,w as M,h as l,q as S,k as U,t as b,j as B,A as j,l as P,y as z,z as A,F as V,i as N,g as q,s as I}from"./index-433b52f5.js";import{_ as F}from"./Accordion.vue_vue_type_script_setup_true_lang-5aba65df.js";import{_ as G}from"./Modal.vue_vue_type_script_setup_true_lang-790bd300.js";const H=async()=>await $.get("plugin/repositories"),O=async()=>await $.get("plugin/packages"),W=async o=>await $.put("plugin/repositories",{repositories:o}),J=async()=>await $.post("plugin/repositories/sync"),K=async o=>await $.post("plugin/packages/install",{name:o}),Q=async o=>await $.post("plugin/packages/uninstall",{name:o}),X=async o=>await $.post("plugin/packages/disable",{name:o}),Y=async o=>await $.post("plugin/packages/enable",{name:o}),Z={class:"px-4 py-2 flex bg-blue-200 rounded-lg"},ss={class:"inline w-full"},ns=["onClick"],es=["onClick"],ts={class:"ml-2 font-bold"},ls={class:"flex w-full"},os=["textContent"],as=x({__name:"Sync",props:{consoleLogs:{type:Array,required:!0}},emits:["synced","addLog","clearLogs"],setup(o,{emit:d}){const n=h(!1),a=h("no-synced"),{t:e}=R(),s=h(null),m=o,c=d,g=E(()=>{switch(a.value){case"no-synced":return e("plugins.statusSync.sync");case"synced":return e("plugins.statusSync.success");case"syncing":return e("plugins.statusSync.syncing");case"error":return e("plugins.statusSync.error")}}),k=E(()=>m.consoleLogs.length?m.consoleLogs[m.consoleLogs.length-1]:g.value),f=r=>{c("addLog",r)},i=()=>{if(s.value){const r=s.value;r.scrollTop=r.scrollHeight+100}},u=()=>{n.value=!0,a.value="syncing",f(g.value),i(),J().then(r=>{r.data.data.forEach(L=>{f(L)}),a.value="synced",c("synced")}).catch(()=>{a.value="error"}).finally(()=>{n.value=!1,f(g.value),i()})},w=()=>{c("clearLogs")};return(r,L)=>{const _=T("fa-icon");return p(),v("div",Z,[y(F,{class:"w-full"},{title:M(()=>[l("div",ss,[l("button",{onClick:S(u,["prevent"]),class:"button secondary small"},[n.value?(p(),U(_,{key:0,class:"animate-spin",icon:"arrows-rotate"})):(p(),U(_,{key:1,icon:"arrow-rotate-right"}))],8,ns),l("button",{onClick:S(w,["prevent"]),class:"ml-2 button default small"},[y(_,{icon:"trash"})],8,es),l("span",ts,b(k.value),1)])]),default:M(()=>{var t;return[l("div",ls,[l("code",{ref_key:"codeLogs",ref:s,class:"overflow-x-auto w-full h-60 bg-blue-100 mt-2 px-4 py-2 rounded-lg text-xs whitespace-pre-line",textContent:b((t=o.consoleLogs)==null?void 0:t.join(`
`))},null,8,os)])]}),_:1})])}}}),is={key:0,class:"flex flex-col md:flex-row w-full justify-between md:items-center hover:bg-gray-100 rounded-lg transition p-4"},us={class:"flex items-end gap-2"},rs={class:"title"},cs={class:"text-gray-500"},ds={class:"text-gray-500 text-sm"},gs={class:"text-gray-500"},ps={class:"flex gap-2 justify-end mt-2 md:mt-0"},bs=["textContent"],vs=["textContent"],ms=x({__name:"PluginItem",props:{plugin:Object},emits:["installing","installed","uninstalling","uninstalled","error","disabling","disabled"],setup(o,{emit:d}){var _;const{t:n}=R(),a=o,e=d,s=h(((_=a.plugin)==null?void 0:_.status)||"unknown"),m=t=>{e("installing",t),s.value="installing",K(t.name).then(()=>{s.value="enabled",e("installed",t)}).catch(()=>{s.value="not-installed",e("error",t)})},c=t=>{e("uninstalling",t),s.value="uninstalling",Q(t.name).then(()=>{s.value="not-installed",e("uninstalled",t)}).catch(()=>{s.value="enabled",e("error",t)})},g=t=>{switch(s.value){case"not-installed":m(t);break;case"enabled":c(t);break}},k=t=>{e("disabling",t),s.value="disabling",X(t.name).then(()=>{s.value="disabled",e("disabled",t)}).catch(()=>{s.value="enabled",e("error",t)})},f=t=>{e("disabling",t),s.value="disabling",Y(t.name).then(()=>{s.value="enabled",e("disabled",t)}).catch(()=>{s.value="disabled",e("error",t)})},i=t=>{switch(s.value){case"enabled":k(t);break;case"disabled":f(t);break}},u={enabled:n("plugins.buttons.disable"),disabled:n("plugins.buttons.enable"),unknown:n("plugins.buttons.unknown")},w={enabled:"default",disabled:"secondary",unknown:"default"},r={"not-installed":n("plugins.buttons.install"),installing:n("plugins.buttons.installing"),enabled:n("plugins.buttons.uninstall"),disabled:n("plugins.buttons.uninstall"),uninstalling:n("plugins.buttons.uninstalling"),unknown:n("plugins.buttons.unknown")},L={"not-installed":"primary",enabled:"danger",disabled:"danger",unknown:"default"};return(t,C)=>o.plugin?(p(),v("div",is,[l("div",null,[l("div",us,[l("h2",rs,b(o.plugin.name),1),B(),l("span",cs,b(o.plugin.version),1)]),l("span",ds,b(o.plugin.author),1),l("p",gs,b(o.plugin.description),1)]),l("div",ps,[["enabled","disabled"].includes(s.value)?(p(),v("button",{key:0,onClick:C[0]||(C[0]=D=>i(o.plugin)),class:j(["w-28 button",w[s.value||"uknown"]]),textContent:b(u[s.value||"uknown"])},null,10,bs)):P("",!0),["enabled","disabled","not-installed"].includes(s.value)?(p(),v("button",{key:1,onClick:C[1]||(C[1]=D=>g(o.plugin)),class:j(["w-28 button",L[s.value||"uknown"]]),textContent:b(r[s.value||"uknown"])},null,10,vs)):P("",!0)])])):P("",!0)}}),fs={class:"flex flex-col"},ys={class:"w-full"},hs=["placeholder"],ks={class:"flex flex-col py-4 overflow-x-auto h-[65vh]"},ws={key:0,class:"my-4"},$s={key:1,class:"flex"},_s={class:"text-center text-gray-500"},xs=x({__name:"Wizzard",props:{plugins:Array},emits:["installing","installed","uninstalling","uninstalled","error"],setup(o){const d=h("");return(n,a)=>{var e;return p(),v("div",fs,[l("div",ys,[z(l("input",{type:"search",class:"input","onUpdate:modelValue":a[0]||(a[0]=s=>d.value=s),placeholder:n.$t("plugins.placeholders.searchPlugin")},null,8,hs),[[A,d.value]])]),l("div",ks,[(e=o.plugins)!=null&&e.length?(p(!0),v(V,{key:0},N(o.plugins,(s,m)=>(p(),v("div",{key:s.name},[y(ms,{plugin:s,onInstalling:a[1]||(a[1]=c=>n.$emit("installing",c)),onInstalled:a[2]||(a[2]=c=>n.$emit("installed",c)),onUninstalling:a[3]||(a[3]=c=>n.$emit("uninstalling",c)),onUninstalled:a[4]||(a[4]=c=>n.$emit("uninstalled",c)),onError:a[5]||(a[5]=c=>n.$emit("error",c))},null,8,["plugin"]),m!==o.plugins.length-1?(p(),v("hr",ws)):P("",!0)]))),128)):(p(),v("div",$s,[l("p",_s,b(n.$t("plugins.labels.noPlugins")),1)]))])])}}}),Ls={class:"w-96 flex flex-col gap-2"},Cs={class:"w-full flex flex-col gap-2"},Ps={class:"form-group"},Ms=["onUpdate:modelValue"],Ss=["onClick"],Rs=["onClick"],Us=x({__name:"Repositories",props:{title:String,showModal:Boolean},emits:["close"],setup(o,{emit:d}){const n=h([]),{t:a}=R(),e=d,s=()=>{n.value.push({url:""})},m=g=>{n.value.splice(g,1)},c=()=>{W(n.value).then(()=>{e("close"),I({title:a("toasts.success"),message:a("plugins.toasts.repositoriesUpdated"),type:"success"})}).catch(()=>{I({title:a("toasts.error"),message:a("plugins.toasts.errorRepositoriesUpdated"),type:"error"})})};return q(()=>{H().then(g=>{n.value=g.data.data})}),(g,k)=>{const f=T("fa-icon");return p(),U(G,{title:g.$t("plugins.titles.repositories"),showModal:o.showModal,confirmLabel:g.$t("buttons.save"),onClose:k[0]||(k[0]=i=>g.$emit("close")),onConfirm:c},{default:M(()=>[l("div",Ls,[l("ul",Cs,[(p(!0),v(V,null,N(n.value,(i,u)=>(p(),v("li",Ps,[z(l("input",{type:"text",class:"input w-full","onUpdate:modelValue":w=>i.url=w},null,8,Ms),[[A,i.url]]),l("button",{class:"button danger",onClick:S(w=>m(u),["prevent"])},[y(f,{icon:"trash"})],8,Ss)]))),256))]),l("div",null,[l("button",{class:"button primary flex gap-2 items-center",onClick:S(s,["prevent"])},[y(f,{icon:"plus"}),l("span",null,b(g.$t("plugins.buttons.addRepository")),1)],8,Rs)])])]),_:1},8,["title","showModal","confirmLabel"])}}}),Is={class:"flex flex-col gap-4 py-2 overflow-hidden"},Ts={class:"title"},Vs={class:"flex gap-2"},Es={class:"grid grid-cols-1 gap-4"},As=x({__name:"Index",setup(o){const{t:d}=R(),n=h(!1),a=h([]),e=h([]),s=()=>{O().then(i=>{a.value=i.data.data}).catch(()=>{I({title:d("toasts.error"),message:d("plugins.toasts.errorGetPackages"),type:"error"})})};q(()=>{s()});const m=({name:i})=>{e.value.push(d("plugins.labels.installingPackage",{name:i}))},c=({name:i})=>{e.value.push(d("plugins.labels.installedPackage",{name:i}))},g=({name:i})=>{e.value.push(d("plugins.labels.uninstallingPackage",{name:i}))},k=({name:i})=>{e.value.push(d("plugins.labels.uninstalledPackage",{name:i}))},f=({name:i})=>{e.value.push(d("plugins.labels.errorInstallingPackage",{name:i}))};return(i,u)=>{const w=T("router-link");return p(),v(V,null,[l("div",Is,[l("h1",Ts,b(i.$t("plugins.titles.index")),1),l("div",Vs,[y(w,{class:"button default",to:{name:"dashboard"}},{default:M(()=>[B(b(i.$t("buttons.back")),1)]),_:1}),l("button",{class:"button primary ml-auto",onClick:u[0]||(u[0]=r=>n.value=!0)},b(i.$t("plugins.buttons.repositories")),1)]),l("div",Es,[y(as,{consoleLogs:e.value,onSynced:s,onAddLog:u[1]||(u[1]=r=>e.value.push(r)),onClearLogs:u[2]||(u[2]=r=>e.value=[])},null,8,["consoleLogs"]),y(xs,{plugins:a.value,onInstalling:u[3]||(u[3]=r=>m(r)),onInstalled:u[4]||(u[4]=r=>c(r)),onUninstalling:u[5]||(u[5]=r=>g(r)),onUninstalled:u[6]||(u[6]=r=>k(r)),onError:u[7]||(u[7]=r=>f(r))},null,8,["plugins"])])]),y(Us,{showModal:n.value,onClose:u[8]||(u[8]=r=>n.value=!1)},null,8,["showModal"])],64)}}});export{As as default};
