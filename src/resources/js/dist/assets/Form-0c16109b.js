import{i as G,v as X,b as de,g as re,c as pe}from"./helpers-d1a74e74.js";import{d as F,e as $,f as B,r as T,o as l,c as v,h as t,A as y,B as me,a as i,j as z,t as p,v as J,l as w,J as ve,_ as E,k as D,w as S,n as M,g as K,F as R,i as be,p as H,m as Q,K as ge,L as j,y as q}from"./index-c7f12366.js";import{D as N}from"./vuedraggable.umd-0f642f2f.js";import{g as fe}from"./ComponentService-3367f154.js";import{_ as he}from"./Group.vue_vue_type_script_setup_true_lang-608ba729.js";import{C as _e,u as Y,_ as $e}from"./ComponentFloatingPreview-23fc195c.js";import{g as Z,p as x,a as ye,u as Ce,b as ke}from"./LocalStorageService-5431b50c.js";import{u as we}from"./ResourceService-c3ecd054.js";import{u as Se}from"./PageService-3b27b221.js";const Ie=["onMousedown"],Ve=F({__name:"FloatToolbar",props:{position:{type:String,default:"top"},isInvisible:{type:Boolean,default:!1},showLabel:{type:String},hiddeLabel:{type:String},canResize:{type:Boolean,default:!1}},emits:["update:isInvisible"],setup(e){const d=e,o=$(Z("float-toolbar-width",500)),a=$(G()),g=B(()=>`position-${d.position}-0`),b=B(()=>{switch(d.position){case"left":return"position-left";case"right":return"position-right";case"top":return"position-top";case"bottom":return"position-bottom"}}),n=s=>{const c=s.clientX,m=o.value,C=P=>{const A=d.position==="left"?m+(P.clientX-c):m-(P.clientX-c);o.value=A<200?200:A,x("float-toolbar-width",o.value)},k=()=>{window.removeEventListener("mousemove",C),window.removeEventListener("mouseup",k)};window.addEventListener("mousemove",C),window.addEventListener("mouseup",k)},f=B(()=>a.value?"100%":d.canResize&&!d.isInvisible?`${o.value}px`:`${["left","right"].includes(d.position)?"initial":"100%"}`);return(s,c)=>{const m=T("fa-icon");return l(),v("div",{style:ve({width:f.value}),class:y(["float-toolbar",b.value,g.value,{"float-toolbar-top":e.position==="top","float-toolbar-right":["left","right"].includes(e.position)}])},[t("div",{class:y(["float-toolbar-container",{"float-toolbar-container-vertical":["top","bottom"].includes(e.position)}])},[t("div",{class:y(["float-toolbar-accordion",{"float-toolbar-accordion-contracted":e.isInvisible,"float-toolbar-accordion-contracted-vertical":e.isInvisible&&["top","bottom"].includes(e.position),"float-toolbar-accordion-contracted-horizontal ":e.isInvisible&&["left","right"].includes(e.position)}])},[t("div",{class:y(["float-toolbar-content",{"rounded-top":e.position==="top","rounded-bottom":e.position==="bottom","rounded-left":e.position==="left","rounded-right":e.position==="right"}])},[me(s.$slots,"default",{},void 0,!0)],2)],2),t("div",{class:y(["float-toolbar-buttons",{"float-toolbar-buttons-vertical":["top","bottom"].includes(e.position),"float-toolbar-buttons-horizontal":["left","right"].includes(e.position),left:e.position==="left",right:e.position==="right",bottom:e.position==="bottom",top:e.position==="top"}])},[t("button",{class:y(["float-toolbar-button",{"vertical-mode":["left","right"].includes(e.position)}]),type:"button",onClick:c[0]||(c[0]=C=>s.$emit("update:isInvisible",!e.isInvisible))},[i(m,{icon:e.isInvisible?"eye":"eye-slash"},null,8,["icon"]),z(" "+p(e.isInvisible?e.showLabel||s.$t("buttons.show"):e.hiddeLabel||s.$t("buttons.hide")),1)],2)],2)],2),e.canResize?(l(),v("div",{key:0,class:"border-l-2 border-l-gray-400 hover:border-l-blue-500 transition-colors h-full hover:cursor-col-resize",onMousedown:J(n,["prevent","stop"])},null,40,Ie)):w("",!0)],6)}}});const ee=E(Ve,[["__scopeId","data-v-511c8ca4"]]),Le={class:"toolbar-container"},Me={class:"toolbar-actions"},Te={class:"flex gap-2"},ze={type:"submit",class:"button primary"},Fe={class:"title"},Ue=["href"],Be={class:"toolbar-route"},De={class:"toolbar-route-input"},Ee={class:"label"},Pe=["value","placeholder"],Ae={class:"toolbar-route-input"},Ne={class:"label"},Re=["value","placeholder"],We={class:"toolbar-route-input"},Xe={class:"label"},je=["value","placeholder"],qe=F({__name:"PageToolbar",props:{showDelete:Boolean,title:String,name:{type:String,default:""},url:{type:String,default:""},pageTitle:{type:String,default:""},pageEditionMode:{type:String,default:"adding-component"}},emits:["delete","update:name","update:pageTitle","update:url"],setup(e){const d=$(!0);return(o,a)=>{const g=T("fa-icon"),b=T("router-link");return l(),D(ee,{isInvisible:d.value,"onUpdate:isInvisible":a[4]||(a[4]=n=>d.value=n),showLabel:o.$t("pages.buttons.settings")},{default:S(()=>[t("div",Le,[t("div",Me,[t("div",Te,[i(b,{class:"button secondary",to:{name:"pages.index"}},{default:S(()=>[i(g,{icon:"arrow-left"}),z(" "+p(o.$t("buttons.back")),1)]),_:1},8,["to"]),e.showDelete?(l(),v("button",{key:0,onClick:a[0]||(a[0]=n=>o.$emit("delete")),type:"button",class:"button danger"},p(o.$t("buttons.delete")),1)):w("",!0),t("button",ze,p(o.$t("buttons.save")),1)]),t("h1",Fe,[z(p(e.title)+" ",1),e.showDelete?(l(),v("a",{key:0,href:e.url,target:"_blank"},[i(g,{icon:"external-link-alt"})],8,Ue)):w("",!0)])]),t("div",Be,[t("div",De,[t("label",Ee,p(o.$t("pages.labels.pageName")),1),t("input",{class:"input",type:"text",required:"",value:e.name,onInput:a[1]||(a[1]=n=>o.$emit("update:name",M(X)(n.target))),placeholder:o.$t("pages.placeholders.pageName")},null,40,Pe)]),t("div",Ae,[t("label",Ne,p(o.$t("pages.labels.pageTitle")),1),t("input",{class:"input",type:"text",value:e.pageTitle,onInput:a[2]||(a[2]=n=>o.$emit("update:pageTitle",M(de)(n.target))),placeholder:o.$t("pages.placeholders.pageTitle")},null,40,Re)]),t("div",We,[t("label",Xe,p(o.$t("pages.labels.pageUrl")),1),t("input",{class:"input",type:"text",value:e.url,onInput:a[3]||(a[3]=n=>o.$emit("update:url",M(X)(n.target))),placeholder:o.$t("pages.placeholders.pageUrl")},null,40,je)])])])]),_:1},8,["isInvisible","showLabel"])}}});const Tt=E(qe,[["__scopeId","data-v-6a5b1085"]]),Oe={class:"overflow-y-auto mt-2"},Ge={class:"tile h-24 cursor-pointer"},Je={class:"text-center"},Ke=F({__name:"AvailableComponents",setup(e){const d=$([]),o=B(()=>re(d.value)),a=$(!1),g=n=>{const f={};n.variables.forEach(c=>{f[c.name]=null});const s={id:n.id||1+1,...n,variables:n.variables.map(c=>({...c})),content:f};return delete s.content_id,s},b=()=>{a.value=!0,fe({withData:!0}).then(n=>{d.value=n.data.data}).finally(()=>{a.value=!1})};return K(()=>{b()}),(n,f)=>{const s=T("fa-icon");return l(),v(R,null,[t("button",{onClick:b,type:"button",class:"button secondary"},[i(s,{icon:"sync",class:y({"animate-spin":a.value})},null,8,["class"]),z(" "+p(n.$t("components.buttons.refresh")),1)]),t("div",Oe,[i(he,{items:o.value},{default:S(c=>[i(M(N),{class:"grid grid-cols-2 gap-4",modelValue:c.item,"onUpdate:modelValue":m=>c.item=m,group:{name:"components",pull:"clone",put:!1},sort:!1,clone:g,"item-key":"id"},{item:S(({element:m,index:C})=>[t("div",Ge,[i(_e,{component:m,class:"flex-1 tile-title cursor-pointer active:cursor-grabbing",position:C%2===0?"left":"right"},{default:S(()=>[t("div",Je,p(M(pe)(m.name)),1)]),_:2},1032,["component","position"])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1},8,["items"])])],64)}}}),He={key:0,class:"component-configuration-parameters"},Qe={class:"component-configuration-label"},Ye=F({__name:"ComponentConfigurationForm",props:{component:{type:Object},position:{type:String,default:"left"}},emits:["update:position"],setup(e,{emit:d}){const o=Y(),a=(b,n)=>{b.content&&(b.content[n]=null)},g=()=>{o.update()};return(b,n)=>{const f=T("fa-icon");return e.component?(l(),v("div",He,[(l(!0),v(R,null,be(e.component.variables,s=>(l(),v("div",{key:s.name},[t("div",Qe,[t("label",null,p(s.name)+":",1),i(f,{class:"component-configuration-set-default",icon:"arrows-rotate",onClick:c=>a(e.component,s.name)},null,8,["onClick"])]),e.component.content?(l(),D(ye,{key:0,editStructure:!1,modelValue:e.component.content[s.name],"onUpdate:modelValue":[c=>e.component.content[s.name]=c,g],"default-value":s.default,name:s.name,type:s.type},null,8,["modelValue","onUpdate:modelValue","default-value","name","type"])):w("",!0)]))),128))])):w("",!0)}}});const Ze=E(Ye,[["__scopeId","data-v-80ba9d1a"]]),xe=e=>(H("data-v-e8ede51d"),e=e(),Q(),e),et=xe(()=>t("hr",null,null,-1)),tt=F({__name:"PageSectionButtonAdd",emits:["click"],setup(e){return(d,o)=>{const a=T("fa-icon");return l(),v("button",{class:"page-sections-buttons-add",onClick:o[0]||(o[0]=J(g=>d.$emit("click"),["stop"])),type:"button"},[et,t("span",null,[i(a,{icon:"square-plus"}),z(" "+p(d.$t("pages.buttons.addSection")),1)])])}}});const O=E(tt,[["__scopeId","data-v-e8ede51d"]]),ot=e=>(H("data-v-aa662b75"),e=e(),Q(),e),nt={class:"w-full p-4 flex flex-col h-[60vh] md:h-full"},st={class:"form-group"},at={class:"page-sections-container"},it={class:"page-sections-content"},lt={class:"page-sections-item-panel"},ct={class:"page-sections-preview"},ut=["onClick"],dt=ot(()=>t("div",{class:"absolute inset-0 cursor-pointer transition-colors hover:bg-yellow-400 active:bg-yellow-200 opacity-50 z-10"},null,-1)),rt={class:"page-sections-item-buttons"},pt={class:"pages-secttions-component-buttons"},mt=["onClick"],vt={class:"page-sections-label"},bt={class:"hideable-header"},gt={class:"page-sections-buttons"},ft={key:0},ht={key:1},_t=["onClick"],$t=F({__name:"Form",props:{sections:{type:Array,default:()=>[{order:0,components:[]},{order:1,components:[]}]},pageEditionMode:{type:String,default:"adding-component"}},emits:["update:sections"],setup(e,{emit:d}){const{loadResources:o}=we(),{loadSources:a}=Ce(),{loadActions:g}=ke(),{loadPages:b}=Se(),n=Y(),f=e,s=$(!0),c=d,m=$(null),C=$(null),k=$("adding-component"),P=u=>{const r=[...f.sections];r.splice(u,0,j({order:0,components:[]})),c("update:sections",r)},A=()=>{c("update:sections",[...f.sections,j({order:0,components:[]})])},te=u=>{const r=[...f.sections];r.splice(u,1),c("update:sections",r)},oe=(u,r)=>{u.splice(r,1)},ne=(u,r)=>{s.value=!1,k.value="editing-component",m.value=u,C.value=r,n.attach(u)},se=()=>{s.value=!0,k.value="adding-component",n.detach(),m.value=null,C.value=null},ae=(u,r)=>{var I,U;return((I=m.value)==null?void 0:I.id)===u.id&&u.order===((U=m.value)==null?void 0:U.order)&&C.value===r},W=$(G()),L=$(Z("float-toolbar-position",W.value?"bottom":"left")),ie=()=>{L.value=L.value==="left"?"right":"left",x("float-toolbar-position",L.value)},le=B(()=>k.value==="adding-component"?"availableComponents":"componentConfigurationForm");return K(()=>{o(),a(),g(),b()}),(u,r)=>{const I=T("fa-icon"),U=ge("autosize");return l(),v(R,null,[i(ee,{isInvisible:s.value,"onUpdate:isInvisible":r[1]||(r[1]=h=>s.value=h),position:L.value,showLabel:u.$t(k.value==="editing-component"?"pages.buttons.settings":"pages.buttons.components"),canResize:!0},{default:S(()=>[t("div",nt,[t("div",{class:y(`component-configuration-title ${L.value}`)},[t("h2",null,p(u.$t(`pages.titles.${le.value}`)),1),t("div",null,[t("div",st,[t("button",{type:"button",class:"button small default",onClick:se},p(u.$t("pages.buttons.exit")),1),W.value?w("",!0):(l(),v("button",{key:0,type:"button",class:"button small default button-position",onClick:ie},[i(I,{icon:"border-top-left"})]))])])],2),k.value==="adding-component"?(l(),D(Ke,{key:0})):w("",!0),k.value==="editing-component"?(l(),D(Ze,{key:1,position:L.value,"onUpdate:position":r[0]||(r[0]=h=>L.value=h),component:m.value},null,8,["position","component"])):w("",!0)])]),_:1},8,["isInvisible","position","showLabel"]),t("div",at,[t("div",it,[i(M(N),{list:e.sections,class:"page-sections-panel",onInput:r[2]||(r[2]=h=>u.$emit("update:sections",h)),group:"sections","item-key":"id"},{item:S(({element:h,index:_})=>[t("div",{class:y(["page-sections-list-content",{"page-sections-list-header":!_,"page-sections-list-footer":_===e.sections.length-1}])},[_?(l(),D(O,{key:0,onClick:V=>P(_)},null,8,["onClick"])):w("",!0),t("div",lt,[i(M(N),{class:"page-sections-dreaggable",modelValue:h.components,"onUpdate:modelValue":V=>h.components=V,disabled:h.components.length===1,group:"components","item-key":"id"},{item:S(({element:V,index:ce})=>[t("div",{class:y(["page-sections-item",{"page-sections-item-selected":ae(V,_)}])},[q((l(),v("div",ct,[q((l(),v("div",{class:"page-sections-preview-content relative",onClick:ue=>ne(V,_)},[dt,i($e,{component:V},null,8,["component"])],8,ut)),[[U]]),t("div",rt,[t("div",pt,[t("button",{type:"button",onClick:ue=>oe(h.components,ce)},[i(I,{icon:"trash"})],8,mt),t("span",vt,p(V.name),1)])])])),[[U]])],2)]),header:S(()=>[t("div",bt,[i(I,{icon:"triangle-exclamation"}),t("p",null,p(u.$t("pages.labels.addComponentsToSection",{section:_})),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"]),t("div",gt,[_?(l(),v("span",ht,p(u.$t(_===e.sections.length-1?"pages.labels.footer":"pages.labels.section",{section:h.order=_})),1)):(l(),v("span",ft,[i(I,{icon:"heading"}),z(" "+p(u.$t("pages.labels.header")),1)])),t("button",{onClick:V=>te(_)},[i(I,{icon:"trash"})],8,_t)])])],2)]),_:1},8,["list"]),i(O,{onClick:A})])])],64)}}});const zt=E($t,[["__scopeId","data-v-aa662b75"]]);export{Tt as P,zt as a};
