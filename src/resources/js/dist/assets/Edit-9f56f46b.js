import{d as _,u as $,n as k,l as P,r as l,o as U,a as R,b as V,e as r,h as v,w as B,t as m,m as F,F as N,s as d,g as S,i as x}from"./index-c4739e21.js";import{P as E}from"./Form-5f45c662.js";import{_ as I}from"./Dialog.vue_vue_type_script_setup_true_lang-7b8b840d.js";import{a as M,d as T,u as j}from"./PageService-370a7c89.js";import{u as q,p as z}from"./ResourceService-024c46aa.js";import"./helpers-6321440c.js";import"./ComponentService-507a2f7d.js";import"./ControlTypeSelector.vue_vue_type_script_setup_true_lang-e52a8eb8.js";import"./Modal.vue_vue_type_script_setup_true_lang-65153d12.js";const A=["onSubmit"],G={class:"flex gap-4 mb-4 w-full"},H={class:"title"},J={type:"submit",class:"button primary"},se=_({__name:"Edit",setup(K){const{t:a}=$(),b=k(),f=P(),n=l(""),u=l(""),i=l(""),g=l(!1),p=l([]),c=+b.params.page,{loadResources:h}=q(),w=()=>{j({id:c,name:n.value,url:u.value,title:i.value,sections:p.value}).then(()=>{f.push({name:"pages.index"}),d({title:a("toasts.success"),message:a("pages.toasts.updated"),type:"success"})}).catch(()=>{d({title:a("toasts.error"),message:a("pages.toasts.errorUpdated"),type:"error"})})},D=t=>t.map(e=>({...e,variables:e.variables.map(o=>z(e,o))})),y=()=>{g.value=!0},C=()=>{T(c).then(()=>{f.push({name:"pages.index"}),d({title:a("toasts.success"),message:a("pages.toasts.deleted"),type:"success"})}).catch(()=>{d({title:a("toasts.error"),message:a("pages.toasts.errorDeleted"),type:"error"})})};return U(()=>{M(c).then(t=>{const e=t.data.data;n.value=e.name,u.value=e.url,i.value=e.title,p.value=e.sections.map(o=>({...o,components:D(o.components)}))}),h()}),(t,e)=>{const o=R("router-link");return S(),V(N,null,[r("form",{onSubmit:F(w,["prevent"])},[r("div",G,[v(o,{class:"button default",to:{name:"pages.index"}},{default:B(()=>[x(m(t.$t("buttons.back")),1)]),_:1},8,["to"]),r("h1",H,m(t.$t("pages.titles.editPage")),1),r("button",{onClick:y,type:"button",class:"button danger ml-auto"},m(t.$t("buttons.delete")),1),r("button",J,m(t.$t("buttons.save")),1)]),v(E,{name:n.value,"onUpdate:name":e[0]||(e[0]=s=>n.value=s),url:u.value,"onUpdate:url":e[1]||(e[1]=s=>u.value=s),sections:p.value,"onUpdate:sections":e[2]||(e[2]=s=>p.value=s),title:i.value,"onUpdate:title":e[3]||(e[3]=s=>i.value=s)},null,8,["name","url","sections","title"])],40,A),v(I,{showDialog:g.value,"onUpdate:showDialog":e[4]||(e[4]=s=>g.value=s),title:t.$t("pages.dialogs.delete.title"),message:t.$t("pages.dialogs.delete.message",{name:n.value}),onConfirm:C},null,8,["showDialog","title","message"])],64)}}});export{se as default};
