import{d as M,o,c as n,g as e,t as y,b as R,x as z,e as L,r as E,a as $,w as I,i as A,q as G,C as H,F as C,h as x,f as J,k as S,l as _,z as K,A as Q,j as D}from"./index-ce9e0ef5.js";import{_ as O}from"./Modal.vue_vue_type_script_setup_true_lang-86180c86.js";import{u as W}from"./ResourceService-2eabafdb.js";import{R as T}from"./ResourcePreview-6a382c18.js";import{v as X}from"./helpers-598837fa.js";const Y=["value"],Z={value:"text"},ee={value:"textarea"},te={value:"resource"},le={value:"datatable"},oe={value:"datasource"},ae=M({__name:"VariableTypeSelector",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(l){const w=u=>u.target.value;return(u,s)=>(o(),n("select",{class:"input",value:l.modelValue,onChange:s[0]||(s[0]=d=>u.$emit("update:modelValue",w(d)))},[e("option",Z,y(u.$t("components.types.text")),1),e("option",ee,y(u.$t("components.types.textarea")),1),e("option",te,y(u.$t("components.types.resource")),1),e("option",le,y(u.$t("components.types.datatable")),1),e("option",oe,y(u.$t("components.types.datasource")),1)],40,Y))}}),B=R([]),ne=async()=>await z.get("source"),ue=async()=>{const l=await ne();B.value=l.data.data},se=()=>({sources:B,loadSources:ue}),re={class:"w-full flex items-center justify-center max-h-full"},ce={class:"absolute top-1/4 bg-teal-500 rounded-lg text-white text-xs p-1 bg-opacity-50"},de={class:"flex justify-between mb-4"},me=["placeholder"],ie={class:"grid grid-cols-3 gap-2 overflow-y-auto max-h-[70vh]"},pe=["onClick"],fe=M({__name:"ResourcePicker",props:{modelValue:{type:[Number,String,Object,void 0],required:!0}},emits:["update:modelValue"],setup(l,{emit:w}){const u=l,s=R(!1),d=R(""),{resources:m,loadResources:r,resourceFromId:i}=W(),f=L(()=>m.value.filter(v=>v.name.toLowerCase().includes(d.value.toLowerCase()))),c=L(()=>{if(u.modelValue!==void 0)return i(+u.modelValue)}),p=w,j=()=>{s.value=!0},N=v=>{p("update:modelValue",v),s.value=!1},U=()=>{r()};return(v,k)=>{var t;const q=E("fa-icon");return o(),n(C,null,[e("button",{onClick:j,type:"button",class:"button secondary flex gap-2 w-full flex-col justify-start !p-1 relative items-center"},[e("div",re,[$(T,{url:(t=c.value)==null?void 0:t.url},null,8,["url"])]),e("span",ce,y(c.value?v.$t("components.buttons.changeResource"):v.$t("components.buttons.selectResource")),1)]),$(O,{title:v.$t("components.titles.selectResource"),showModal:s.value,"onUpdate:showModal":k[1]||(k[1]=a=>s.value=a),showCancel:!1,confirmLabel:v.$t("buttons.close")},{default:I(()=>[e("div",de,[e("button",{type:"button",onClick:U,class:"button secondary"},[$(q,{icon:"arrow-rotate-right"}),A(" "+y(v.$t("components.buttons.refresh")),1)]),G(e("input",{type:"search","onUpdate:modelValue":k[0]||(k[0]=a=>d.value=a),class:"input",placeholder:v.$t("placeholders.search")},null,8,me),[[H,d.value]])]),e("div",ie,[(o(!0),n(C,null,x(f.value,a=>(o(),n("button",{type:"button",onClick:V=>N(a.id),class:"button primary flex flex-col gap-2 justify-center items-center"},[$(T,{url:a.url},null,8,["url"]),e("span",null,y(a.name),1)],8,pe))),256))])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),ve={class:"w-52 flex"},he={class:"w-full form-group"},ye=["value","onInput","placeholder"],Ve=["onClick"],be=e("th",null," Â  ",-1),$e={class:"w-52 flex"},we=["onClick"],ge=M({__name:"DataTable",props:{modelValue:{type:[Object,String,Number,void 0],required:!0},name:{type:String,required:!1}},emits:["update:modelValue"],setup(l,{emit:w}){const u=l,s=({type:t,name:a}={type:"text",name:""})=>({name:a,type:t,value:"",default:""}),d=(t="text")=>({name:"",type:t}),m=R([d()]),r=R([[s()]]),i=R(!1),f=w,c=()=>{i.value=!0},p=()=>{f("update:modelValue",{columns:m.value,rows:r.value}),i.value=!1},j=(t,a,V)=>{a.type=V,r.value.forEach(h=>{h[t].type=a.type})},N=(t,a,V)=>{a.name=X(V),r.value.forEach(h=>{h[t].name=a.name})},U=()=>{m.value.push(d()),r.value.forEach(t=>{t.push(s())})},v=()=>{const t=[];m.value.forEach(({type:a,name:V})=>{t.push(s({type:a,name:V}))}),r.value.push(t)},k=t=>{m.value.splice(t,1),r.value.forEach(a=>{a.splice(t,1)})},q=t=>{r.value.splice(t,1)};return J(()=>{u.modelValue&&typeof u.modelValue=="object"&&(m.value=u.modelValue.columns,r.value=u.modelValue.rows)}),(t,a)=>{const V=E("fa-icon");return o(),n(C,null,[e("button",{onClick:c,type:"button",class:"button secondary flex gap-2 w-full"},[e("span",null,y(t.$t("components.buttons.fillData")),1)]),$(O,{title:t.$t("components.titles.fillData"),showModal:i.value,"onUpdate:showModal":a[0]||(a[0]=h=>i.value=h),showCancel:!1,confirmLabel:t.$t("buttons.close"),resetOnClose:!1,onConfirm:p},{default:I(()=>[e("table",null,[e("thead",null,[e("tr",null,[(o(!0),n(C,null,x(m.value,(h,g)=>(o(),n("th",null,[e("div",ve,[e("div",he,[e("input",{class:"input",type:"text",value:h.name,onInput:b=>N(g,h,b.target),placeholder:t.$t("components.placeholders.dataName")},null,40,ye),$(ae,{class:"w-5",modelValue:h.type,"onUpdate:modelValue":b=>j(g,h,b)},null,8,["modelValue","onUpdate:modelValue"]),m.value.length>1?(o(),n("button",{key:0,type:"button",class:"button danger",onClick:b=>k(g)},[$(V,{icon:"minus"})],8,Ve)):S("",!0),g==m.value.length-1?(o(),n("button",{key:1,type:"button",class:"button primary",onClick:U},[$(V,{icon:"plus"})])):S("",!0)])])]))),256)),be])]),e("tbody",null,[(o(!0),n(C,null,x(r.value,(h,g)=>(o(),n("tr",{key:`${g}:${l.name}`},[(o(!0),n(C,null,x(h,(b,F)=>(o(),n("td",{key:`${l.name}:${m.value[F].name}:${b.name}`},[e("div",$e,[$(Me,{modelValue:b.default,"onUpdate:modelValue":P=>b.default=P,name:b.name,type:b.type},null,8,["modelValue","onUpdate:modelValue","name","type"])])]))),128)),e("td",null,[r.value.length>1?(o(),n("button",{key:0,type:"button",class:"button danger",onClick:b=>q(g)},[$(V,{icon:"minus"})],8,we)):S("",!0),g==r.value.length-1?(o(),n("button",{key:1,type:"button",class:"button secondary",onClick:v},[$(V,{icon:"plus"})])):S("",!0)])]))),128))])])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),Ce={class:"input w-full"},ke={value:""},_e={value:"text"},Se=M({__name:"DataSource",setup(l){const{sources:w}=se();return(u,s)=>(o(),n("select",Ce,[e("option",ke,y(u.$t("placeholders.select")),1),(o(!0),n(C,null,x(_(w),d=>(o(),n("option",_e,y(d.name),1))),256))]))}}),Re=["value","placeholder"],xe=["placeholder"],Me=M({__name:"ControlTypeSelector",props:{type:{type:String,required:!0},modelValue:{type:[String,Number,Object,null,void 0],required:!0},name:{type:String,required:!0},defaultValue:{type:[String,Number,Object,null,void 0]}},emits:["update:modelValue"],setup(l,{emit:w}){const u=l,s=w,d=f=>{s("update:modelValue",f.target.value)},m=f=>{s("update:modelValue",f)},r=f=>{s("update:modelValue",f)},{type:i}=K(u);return Q(i,()=>{s("update:modelValue","")}),(f,c)=>(o(),n(C,null,[_(i)==="text"?(o(),n("input",{key:0,type:"text",class:"input w-full",value:l.modelValue||l.defaultValue,onInput:c[0]||(c[0]=p=>d(p)),placeholder:f.$t("components.placeholders.defaultValue")},null,40,Re)):S("",!0),_(i)==="textarea"?(o(),n("textarea",{key:1,class:"input w-full",onInput:c[1]||(c[1]=p=>d(p)),placeholder:f.$t("components.placeholders.defaultValue")},y(l.modelValue||l.defaultValue),41,xe)):_(i)==="resource"?(o(),D(fe,{key:2,modelValue:l.modelValue||l.defaultValue,"onUpdate:modelValue":c[2]||(c[2]=p=>m(p))},null,8,["modelValue"])):_(i)==="datatable"?(o(),D(ge,{key:3,name:l.name,modelValue:l.modelValue||l.defaultValue,"onUpdate:modelValue":c[3]||(c[3]=p=>r(p))},null,8,["name","modelValue"])):_(i)==="datasource"?(o(),D(Se,{key:4,name:l.name,modelValue:l.modelValue||l.defaultValue,"onUpdate:modelValue":c[4]||(c[4]=p=>r(p))},null,8,["name","modelValue"])):S("",!0)],64))}});export{ae as _,Me as a,se as u};
