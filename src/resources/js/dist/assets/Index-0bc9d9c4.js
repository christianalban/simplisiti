import{y as $,d as _,b,u as L,e as V,r as S,o as g,c as f,a as h,w,g as t,n as x,j as P,t as p,i as E,q as A,k as B,v as T,D as j,F as R,h as N,f as z,s as M}from"./index-1dadd938.js";import{_ as D}from"./Accordion.vue_vue_type_script_setup_true_lang-4d586959.js";import{_ as q}from"./Modal.vue_vue_type_script_setup_true_lang-6b69fae9.js";const F=async()=>await $.get("plugin/repositories"),G=async()=>await $.get("plugin/packages"),H=async a=>await $.put("plugin/repositories",{repositories:a}),O=async()=>await $.post("plugin/repositories/sync"),W=async a=>await $.post("plugin/packages/install",{name:a}),J=async a=>await $.post("plugin/packages/uninstall",{name:a}),K={class:"px-4 py-2 flex bg-blue-200 rounded-lg"},Q={class:"inline w-full"},X=["onClick"],Y=["onClick"],Z={class:"ml-2 font-bold"},ss={class:"flex w-full"},ts=["textContent"],ns=_({__name:"Sync",props:{consoleLogs:{type:Array,required:!0}},emits:["synced","addLog","clearLogs"],setup(a,{emit:c}){const n=b(!1),e=b("no-synced"),{t:l}=L(),i=b(null),v=a,r=c,d=V(()=>{switch(e.value){case"no-synced":return l("plugins.statusSync.sync");case"synced":return l("plugins.statusSync.success");case"syncing":return l("plugins.statusSync.syncing");case"error":return l("plugins.statusSync.error")}}),k=V(()=>v.consoleLogs.length?v.consoleLogs[v.consoleLogs.length-1]:d.value),m=u=>{r("addLog",u)},o=()=>{if(i.value){const u=i.value;u.scrollTop=u.scrollHeight+100}},s=()=>{n.value=!0,e.value="syncing",m(d.value),o(),O().then(u=>{u.data.data.forEach(U=>{m(U)}),e.value="synced",r("synced")}).catch(()=>{e.value="error"}).finally(()=>{n.value=!1,m(d.value),o()})},y=()=>{r("clearLogs")};return(u,U)=>{const C=S("fa-icon");return g(),f("div",K,[h(D,{class:"w-full"},{title:w(()=>[t("div",Q,[t("button",{onClick:x(s,["prevent"]),class:"button secondary small"},[n.value?(g(),P(C,{key:0,class:"animate-spin",icon:"arrows-rotate"})):(g(),P(C,{key:1,icon:"arrow-rotate-right"}))],8,X),t("button",{onClick:x(y,["prevent"]),class:"ml-2 button default small"},[h(C,{icon:"trash"})],8,Y),t("span",Z,p(k.value),1)])]),default:w(()=>{var I;return[t("div",ss,[t("code",{ref_key:"codeLogs",ref:i,class:"overflow-x-auto w-full h-60 bg-blue-100 mt-2 px-4 py-2 rounded-lg text-xs whitespace-pre-line",textContent:p((I=a.consoleLogs)==null?void 0:I.join(`
`))},null,8,ts)])]}),_:1})])}}}),es={key:0,class:"flex w-full justify-between items-center hover:bg-gray-100 rounded-lg transition p-4"},ls={class:"flex items-end gap-2"},os={class:"title"},as={class:"text-gray-500"},is={class:"text-gray-500 text-sm"},us={class:"text-gray-500"},rs=["textContent"],cs=_({__name:"PluginItem",props:{plugin:Object},emits:["installing","installed","uninstalling","uninstalled","error"],setup(a,{emit:c}){var o;const{t:n}=L(),e=a,l=c,i=b(((o=e.plugin)==null?void 0:o.status)||"unknown"),v=s=>{l("installing",s),i.value="installing",W(s.name).then(()=>{i.value="enabled",l("installed",s)}).catch(()=>{i.value="not-installed",l("error",s)})},r=s=>{l("uninstalling",s),i.value="uninstalling",J(s.name).then(()=>{i.value="not-installed",l("uninstalled",s)}).catch(()=>{i.value="enabled",l("error",s)})},d=s=>{switch(i.value){case"not-installed":v(s);break;case"enabled":r(s);break}},k={"not-installed":n("plugins.buttons.install"),installing:n("plugins.buttons.installing"),enabled:n("plugins.buttons.uninstall"),uninstalling:n("plugins.buttons.uninstalling"),unknown:n("plugins.buttons.unknown")},m={"not-installed":"primary",enabled:"danger",unknown:"default"};return(s,y)=>a.plugin?(g(),f("div",es,[t("div",null,[t("div",ls,[t("h2",os,p(a.plugin.name),1),E(),t("span",as,p(a.plugin.version),1)]),t("span",is,p(a.plugin.author),1),t("p",us,p(a.plugin.description),1)]),t("button",{onClick:y[0]||(y[0]=u=>d(a.plugin)),class:A(["w-28 button",m[i.value||"uknown"]]),textContent:p(k[i.value||"uknown"])},null,10,rs)])):B("",!0)}}),ds={class:"flex flex-col overflow-x-auto h-screen"},gs={class:"w-full"},ps=["placeholder"],vs={class:"flex flex-col py-4"},ms={key:0,class:"my-4"},fs={key:1,class:"flex"},ys={class:"text-center text-gray-500"},hs=_({__name:"Wizzard",props:{plugins:Array},emits:["installing","installed","uninstalling","uninstalled","error"],setup(a){const c=b("");return(n,e)=>{var l;return g(),f("div",ds,[t("div",gs,[T(t("input",{type:"search",class:"input","onUpdate:modelValue":e[0]||(e[0]=i=>c.value=i),placeholder:n.$t("plugins.placeholders.searchPlugin")},null,8,ps),[[j,c.value]])]),t("div",vs,[(l=a.plugins)!=null&&l.length?(g(!0),f(R,{key:0},N(a.plugins,(i,v)=>(g(),f("div",{key:i.name},[h(cs,{plugin:i,onInstalling:e[1]||(e[1]=r=>n.$emit("installing",r)),onInstalled:e[2]||(e[2]=r=>n.$emit("installed",r)),onUninstalling:e[3]||(e[3]=r=>n.$emit("uninstalling",r)),onUninstalled:e[4]||(e[4]=r=>n.$emit("uninstalled",r)),onError:e[5]||(e[5]=r=>n.$emit("error",r))},null,8,["plugin"]),v!==a.plugins.length-1?(g(),f("hr",ms)):B("",!0)]))),128)):(g(),f("div",fs,[t("p",ys,p(n.$t("plugins.labels.noPlugins")),1)]))])])}}}),bs={class:"w-96 flex flex-col gap-2"},ks={class:"w-full flex flex-col gap-2"},$s={class:"form-group"},_s=["onUpdate:modelValue"],ws=["onClick"],xs=["onClick"],Ls=_({__name:"Repositories",props:{title:String,showModal:Boolean},emits:["close"],setup(a,{emit:c}){const n=b([]),{t:e}=L(),l=c,i=()=>{n.value.push({url:""})},v=d=>{n.value.splice(d,1)},r=()=>{H(n.value).then(()=>{l("close"),M({title:e("toasts.success"),message:e("plugins.toasts.repositoriesUpdated"),type:"success"})}).catch(()=>{M({title:e("toasts.error"),message:e("plugins.toasts.errorRepositoriesUpdated"),type:"error"})})};return z(()=>{F().then(d=>{n.value=d.data.data})}),(d,k)=>{const m=S("fa-icon");return g(),P(q,{title:d.$t("plugins.titles.repositories"),showModal:a.showModal,confirmLabel:d.$t("buttons.save"),onClose:k[0]||(k[0]=o=>d.$emit("close")),onConfirm:r},{default:w(()=>[t("div",bs,[t("ul",ks,[(g(!0),f(R,null,N(n.value,(o,s)=>(g(),f("li",$s,[T(t("input",{type:"text",class:"input w-full","onUpdate:modelValue":y=>o.url=y},null,8,_s),[[j,o.url]]),t("button",{class:"button danger",onClick:x(y=>v(s),["prevent"])},[h(m,{icon:"trash"})],8,ws)]))),256))]),t("div",null,[t("button",{class:"button primary flex gap-2 items-center",onClick:x(i,["prevent"])},[h(m,{icon:"plus"}),t("span",null,p(d.$t("plugins.buttons.addRepository")),1)],8,xs)])])]),_:1},8,["title","showModal","confirmLabel"])}}}),Cs={class:"flex flex-col gap-4 h-screen py-2 overflow-hidden"},Ps={class:"title"},Ms={class:"flex gap-2"},Ss={class:"grid grid-cols-1 gap-4"},Vs=_({__name:"Index",setup(a){const{t:c}=L(),n=b(!1),e=b([]),l=b([]),i=()=>{G().then(o=>{e.value=o.data.data}).catch(()=>{M({title:c("toasts.error"),message:c("plugins.toasts.errorGetPackages"),type:"error"})})};z(()=>{i()});const v=({name:o})=>{l.value.push(c("plugins.labels.installingPackage",{name:o}))},r=({name:o})=>{l.value.push(c("plugins.labels.installedPackage",{name:o}))},d=({name:o})=>{l.value.push(c("plugins.labels.uninstallingPackage",{name:o}))},k=({name:o})=>{l.value.push(c("plugins.labels.uninstalledPackage",{name:o}))},m=({name:o})=>{l.value.push(c("plugins.labels.errorInstallingPackage",{name:o}))};return(o,s)=>{const y=S("router-link");return g(),f(R,null,[t("div",Cs,[t("h1",Ps,p(o.$t("plugins.titles.index")),1),t("div",Ms,[h(y,{class:"button default",to:{name:"dashboard"}},{default:w(()=>[E(p(o.$t("buttons.back")),1)]),_:1}),t("button",{class:"button primary ml-auto",onClick:s[0]||(s[0]=u=>n.value=!0)},p(o.$t("plugins.buttons.repositories")),1)]),t("div",Ss,[h(ns,{consoleLogs:l.value,onSynced:i,onAddLog:s[1]||(s[1]=u=>l.value.push(u)),onClearLogs:s[2]||(s[2]=u=>l.value=[])},null,8,["consoleLogs"]),h(hs,{plugins:e.value,onInstalling:s[3]||(s[3]=u=>v(u)),onInstalled:s[4]||(s[4]=u=>r(u)),onUninstalling:s[5]||(s[5]=u=>d(u)),onUninstalled:s[6]||(s[6]=u=>k(u)),onError:s[7]||(s[7]=u=>m(u))},null,8,["plugins"])])]),h(Ls,{showModal:n.value,onClose:s[8]||(s[8]=u=>n.value=!1)},null,8,["showModal"])],64)}}});export{Vs as default};
