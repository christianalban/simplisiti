import{d as x,o,c as n,g as e,t as y,b as R,x as z,e as L,r as E,a as $,w as I,i as A,q as G,C as H,F as C,h as M,f as J,k as S,l as _,z as K,A as Q,j as D}from"./index-ad68ceb6.js";import{_ as O}from"./Modal.vue_vue_type_script_setup_true_lang-862cce45.js";import{u as W}from"./ResourceService-2ec5b8b9.js";import{R as T}from"./ResourcePreview-d5b1d25d.js";import{v as X}from"./helpers-ddca868d.js";const Y=["value"],Z={value:"text"},ee={value:"textarea"},te={value:"resource"},le={value:"datatable"},oe={value:"datasource"},ae=x({__name:"VariableTypeSelector",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(t){const w=u=>u.target.value;return(u,r)=>(o(),n("select",{class:"input",value:t.modelValue,onChange:r[0]||(r[0]=i=>u.$emit("update:modelValue",w(i)))},[e("option",Z,y(u.$t("components.types.text")),1),e("option",ee,y(u.$t("components.types.textarea")),1),e("option",te,y(u.$t("components.types.resource")),1),e("option",le,y(u.$t("components.types.datatable")),1),e("option",oe,y(u.$t("components.types.datasource")),1)],40,Y))}}),B=R([]),ne=async()=>await z.get("source"),ue=async()=>{const t=await ne();B.value=t.data.data},se=()=>({sources:B,loadSources:ue}),re={class:"w-full flex items-center justify-center max-h-full"},ce={class:"absolute top-1/4 bg-teal-500 rounded-lg text-white text-xs p-1 bg-opacity-50"},de={class:"flex justify-between mb-4"},me=["placeholder"],ie={class:"grid grid-cols-3 gap-2 overflow-y-auto max-h-[70vh]"},pe=["onClick"],fe=x({__name:"ResourcePicker",props:{modelValue:{type:[Number,String,Object,void 0],required:!0}},emits:["update:modelValue"],setup(t,{emit:w}){const u=t,r=R(!1),i=R(""),{resources:c,loadResources:s,resourceFromId:d}=W(),f=L(()=>c.value.filter(v=>v.name.toLowerCase().includes(i.value.toLowerCase()))),m=L(()=>{if(u.modelValue!==void 0)return d(+u.modelValue)}),p=w,j=()=>{r.value=!0},q=v=>{p("update:modelValue",v),r.value=!1},N=()=>{s()};return(v,k)=>{var l;const U=E("fa-icon");return o(),n(C,null,[e("button",{onClick:j,type:"button",class:"button secondary flex gap-2 w-full flex-col justify-start !p-1 relative items-center"},[e("div",re,[$(T,{url:(l=m.value)==null?void 0:l.url},null,8,["url"])]),e("span",ce,y(m.value?v.$t("components.buttons.changeResource"):v.$t("components.buttons.selectResource")),1)]),$(O,{title:v.$t("components.titles.selectResource"),showModal:r.value,"onUpdate:showModal":k[1]||(k[1]=a=>r.value=a),showCancel:!1,confirmLabel:v.$t("buttons.close")},{default:I(()=>[e("div",de,[e("button",{type:"button",onClick:N,class:"button secondary"},[$(U,{icon:"arrow-rotate-right"}),A(" "+y(v.$t("components.buttons.refresh")),1)]),G(e("input",{type:"search","onUpdate:modelValue":k[0]||(k[0]=a=>i.value=a),class:"input",placeholder:v.$t("placeholders.search")},null,8,me),[[H,i.value]])]),e("div",ie,[(o(!0),n(C,null,M(f.value,a=>(o(),n("button",{type:"button",onClick:V=>q(a.id),class:"button primary flex flex-col gap-2 justify-center items-center"},[$(T,{url:a.url},null,8,["url"]),e("span",null,y(a.name),1)],8,pe))),256))])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),ve={class:"w-52 flex"},he={class:"w-full form-group"},ye=["value","onInput","placeholder"],Ve=["onClick"],be=e("th",null," Â  ",-1),$e={class:"w-52 flex"},we=["onClick"],ge=x({__name:"DataTable",props:{modelValue:{type:[Object,String,Number,void 0],required:!0},name:{type:String,required:!1}},emits:["update:modelValue"],setup(t,{emit:w}){const u=t,r=({type:l,name:a}={type:"text",name:""})=>({name:a,type:l,value:"",default:""}),i=(l="text")=>({name:"",type:l}),c=R([i()]),s=R([[r()]]),d=R(!1),f=w,m=()=>{d.value=!0},p=()=>{f("update:modelValue",{columns:c.value,rows:s.value}),d.value=!1},j=(l,a,V)=>{a.type=V,s.value.forEach(h=>{h[l].type=a.type})},q=(l,a,V)=>{a.name=X(V),s.value.forEach(h=>{h[l].name=a.name})},N=()=>{c.value.push(i()),s.value.forEach(l=>{l.push(r())})},v=()=>{const l=[];c.value.forEach(({type:a,name:V})=>{l.push(r({type:a,name:V}))}),s.value.push(l)},k=l=>{c.value.splice(l,1),s.value.forEach(a=>{a.splice(l,1)})},U=l=>{s.value.splice(l,1)};return J(()=>{u.modelValue&&typeof u.modelValue=="object"&&(c.value=u.modelValue.columns,s.value=u.modelValue.rows)}),(l,a)=>{const V=E("fa-icon");return o(),n(C,null,[e("button",{onClick:m,type:"button",class:"button secondary flex gap-2 w-full"},[e("span",null,y(l.$t("components.buttons.fillData")),1)]),$(O,{title:l.$t("components.titles.fillData"),showModal:d.value,"onUpdate:showModal":a[0]||(a[0]=h=>d.value=h),showCancel:!1,confirmLabel:l.$t("buttons.close"),resetOnClose:!1,onConfirm:p},{default:I(()=>[e("table",null,[e("thead",null,[e("tr",null,[(o(!0),n(C,null,M(c.value,(h,g)=>(o(),n("th",null,[e("div",ve,[e("div",he,[e("input",{class:"input",type:"text",value:h.name,onInput:b=>q(g,h,b.target),placeholder:l.$t("components.placeholders.dataName")},null,40,ye),$(ae,{class:"w-5",modelValue:h.type,"onUpdate:modelValue":b=>j(g,h,b)},null,8,["modelValue","onUpdate:modelValue"]),c.value.length>1?(o(),n("button",{key:0,type:"button",class:"button danger",onClick:b=>k(g)},[$(V,{icon:"minus"})],8,Ve)):S("",!0),g==c.value.length-1?(o(),n("button",{key:1,type:"button",class:"button primary",onClick:N},[$(V,{icon:"plus"})])):S("",!0)])])]))),256)),be])]),e("tbody",null,[(o(!0),n(C,null,M(s.value,(h,g)=>(o(),n("tr",{key:`${g}:${t.name}`},[(o(!0),n(C,null,M(h,(b,F)=>(o(),n("td",{key:`${t.name}:${c.value[F].name}:${b.name}`},[e("div",$e,[$(xe,{modelValue:b.default,"onUpdate:modelValue":P=>b.default=P,name:b.name,type:b.type},null,8,["modelValue","onUpdate:modelValue","name","type"])])]))),128)),e("td",null,[s.value.length>1?(o(),n("button",{key:0,type:"button",class:"button danger",onClick:b=>U(g)},[$(V,{icon:"minus"})],8,we)):S("",!0),g==s.value.length-1?(o(),n("button",{key:1,type:"button",class:"button secondary",onClick:v},[$(V,{icon:"plus"})])):S("",!0)])]))),128))])])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),Ce=["value"],ke={value:""},_e=["value"],Se=x({__name:"DataSource",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:modelValue"],setup(t,{emit:w}){const{sources:u}=se(),r=w,i=c=>{const s=c.target;r("update:modelValue",s.value)};return(c,s)=>(o(),n("select",{class:"input w-full",onChange:i,value:t.modelValue},[e("option",ke,y(c.$t("placeholders.select")),1),(o(!0),n(C,null,M(_(u),d=>(o(),n("option",{value:d.name},y(d.name),9,_e))),256))],40,Ce))}}),Re=["value","placeholder"],Me=["placeholder"],xe=x({__name:"ControlTypeSelector",props:{type:{type:String,required:!0},modelValue:{type:[String,Number,Object,null,void 0],required:!0},name:{type:String,required:!0},defaultValue:{type:[String,Number,Object,null,void 0]}},emits:["update:modelValue"],setup(t,{emit:w}){const u=t,r=w,i=f=>{r("update:modelValue",f.target.value)},c=f=>{r("update:modelValue",f)},s=f=>{r("update:modelValue",f)},{type:d}=K(u);return Q(d,()=>{r("update:modelValue","")}),(f,m)=>(o(),n(C,null,[_(d)==="text"?(o(),n("input",{key:0,type:"text",class:"input w-full",value:t.modelValue||t.defaultValue,onInput:m[0]||(m[0]=p=>i(p)),placeholder:f.$t("components.placeholders.defaultValue")},null,40,Re)):S("",!0),_(d)==="textarea"?(o(),n("textarea",{key:1,class:"input w-full",onInput:m[1]||(m[1]=p=>i(p)),placeholder:f.$t("components.placeholders.defaultValue")},y(t.modelValue||t.defaultValue),41,Me)):_(d)==="resource"?(o(),D(fe,{key:2,modelValue:t.modelValue||t.defaultValue,"onUpdate:modelValue":m[2]||(m[2]=p=>c(p))},null,8,["modelValue"])):_(d)==="datatable"?(o(),D(ge,{key:3,name:t.name,modelValue:t.modelValue||t.defaultValue,"onUpdate:modelValue":m[3]||(m[3]=p=>s(p))},null,8,["name","modelValue"])):_(d)==="datasource"?(o(),D(Se,{key:4,name:t.name,modelValue:t.modelValue||t.defaultValue,"onUpdate:modelValue":m[4]||(m[4]=p=>s(p))},null,8,["name","modelValue"])):S("",!0)],64))}});export{ae as _,xe as a,se as u};
