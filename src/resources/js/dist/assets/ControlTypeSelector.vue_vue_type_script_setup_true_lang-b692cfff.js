import{e as x,b as z,d as U,o,c as r,h as t,t as y,f as B,r as O,a as C,w as P,y as W,j as X,z as Y,G as Z,F as k,i as E,g as ee,D as I,k as T,l as j,M as te,n as R,C as le}from"./index-bc76539c.js";import{_ as G}from"./Modal.vue_vue_type_script_setup_true_lang-6a95c102.js";import{u as oe}from"./ResourceService-8e747c27.js";import{R as F}from"./ResourcePreview-a544fe54.js";import{v as ae}from"./helpers-66e66eca.js";const H=x([]),ne=async()=>await z.get("source"),ue=async()=>{const s=await ne();H.value=s.data.data},se=()=>({sources:H,loadSources:ue}),J=x([]),re=async()=>await z.get("action"),ce=async()=>{const s=await re();J.value=s.data.data},de=()=>({actions:J,loadActions:ce}),ie=["value"],me={value:"text"},pe={value:"textarea"},fe={value:"resource"},ve={value:"datatable"},he={value:"datasource"},ye={value:"action"},Ve=U({__name:"VariableTypeSelector",props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(s){const b=n=>n.target.value;return(n,d)=>(o(),r("select",{class:"input",value:s.modelValue,onChange:d[0]||(d[0]=m=>n.$emit("update:modelValue",b(m)))},[t("option",me,y(n.$t("components.types.text")),1),t("option",pe,y(n.$t("components.types.textarea")),1),t("option",fe,y(n.$t("components.types.resource")),1),t("option",ve,y(n.$t("components.types.datatable")),1),t("option",he,y(n.$t("components.types.datasource")),1),t("option",ye,y(n.$t("components.types.action")),1)],40,ie))}}),$e={class:"w-full flex items-center justify-center max-h-full"},be={class:"absolute top-1/4 bg-teal-500 rounded-lg text-white text-xs p-1 bg-opacity-50"},ge={class:"flex flex-col md:flex-row gap-2 justify-between mb-4"},_e=["placeholder"],we={class:"grid grid-cols-2 md:grid-cols-3 gap-2 overflow-y-auto max-h-[70vh]"},Ce=["onClick"],ke=U({__name:"ResourcePicker",props:{modelValue:{required:!0}},emits:["update:modelValue"],setup(s,{emit:b}){const n=s,d=x(!1),m=x(""),p=x(!1),{resources:c,loadResources:u,resourceFromId:S}=oe(),g=B(()=>c.value.filter(V=>V.name.toLowerCase().includes(m.value.toLowerCase()))),_=B(()=>{if(!(n.modelValue===void 0||n.modelValue===null))return S(+n.modelValue)}),f=b,v=()=>{d.value=!0},h=V=>{f("update:modelValue",V),d.value=!1},L=()=>{p.value=!0,u().finally(()=>{p.value=!1})};return(V,q)=>{var D;const N=O("fa-icon");return o(),r(k,null,[t("button",{onClick:v,type:"button",class:"button secondary flex gap-2 w-full flex-col justify-start !p-1 relative items-center"},[t("div",$e,[C(F,{url:(D=_.value)==null?void 0:D.url},null,8,["url"])]),t("span",be,y(_.value?V.$t("components.buttons.changeResource"):V.$t("components.buttons.selectResource")),1)]),C(G,{title:V.$t("components.titles.selectResource"),showModal:d.value,"onUpdate:showModal":q[1]||(q[1]=$=>d.value=$),showCancel:!1,confirmLabel:V.$t("buttons.close")},{default:P(()=>[t("div",ge,[t("button",{type:"button",onClick:L,class:"button secondary"},[C(N,{icon:"sync",class:W({"animate-spin":p.value})},null,8,["class"]),X(" "+y(V.$t("resources.buttons.refresh")),1)]),Y(t("input",{type:"search","onUpdate:modelValue":q[0]||(q[0]=$=>m.value=$),class:"input",placeholder:V.$t("placeholders.search")},null,8,_e),[[Z,m.value]])]),t("div",we,[(o(!0),r(k,null,E(g.value,$=>(o(),r("button",{type:"button",onClick:e=>h($.id),class:"button primary flex flex-col gap-2 justify-center items-center"},[C(F,{url:$.url},null,8,["url"]),t("span",null,y($.name),1)],8,Ce))),256))])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),Se={class:"overflow-y-auto h-[70vh]"},Re={class:"w-full relative"},xe={class:"sticky top-0 z-10"},Me={class:"flex"},je={class:"w-full form-group"},qe=["value","onInput","placeholder","readonly"],De=["onClick"],Ee={class:"sticky top-0 z-10"},Ue={class:"flex justify-center"},Te={class:"flex"},Le={class:"flex flex-col gap-1"},Ne=["onClick"],Be=U({__name:"DataTable",props:{modelValue:{required:!0},name:{type:String,required:!1},editStructure:{type:Boolean,default:!0}},emits:["update:model-value"],setup(s,{emit:b}){const n=s,d=[],m=({type:e,name:l}={type:"text",name:""})=>{let a="";return e==="datatable"&&(a={columns:[p()],rows:[[m()]]}),{name:l,type:e,value:"",default:a}},p=(e="text")=>({name:"",type:e}),c=x([p()]),u=x([[m()]]),S=x(!1),g=b,_=()=>{S.value=!0},f=()=>{g("update:model-value",{columns:c.value,rows:u.value}),S.value=!1},v=(e,l,a)=>{l.type=a,u.value.forEach(i=>{i[e].type=l.type})},h=(e,l,a)=>{l.name=ae(a),u.value.forEach(i=>{i[e].name=l.name})},L=()=>{c.value.push(p()),u.value.forEach(e=>{e.push(m())})},V=()=>{const e=[];c.value.forEach(({type:l,name:a})=>{e.push(m({type:l,name:a}))}),u.value.push(e),$()},q=e=>{c.value.splice(e,1),u.value.forEach(l=>{l.splice(e,1)})},N=e=>{u.value.splice(e,1)},D=()=>{u.value[0].forEach((e,l)=>{var a;e.type==="datatable"&&typeof e.default=="object"&&(d[l]=((a=e.default)==null?void 0:a.columns)||[p()])})},$=()=>{u.value.forEach(e=>{e.forEach((l,a)=>{var i;l.type==="datatable"&&l.default&&typeof l.default=="object"&&(l.default.columns=d[a]),l.name=((i=c.value[a])==null?void 0:i.name)||""})})};return ee(()=>{if(n.modelValue&&typeof n.modelValue=="object"){const e=n.modelValue;c.value=e.columns,u.value=e.rows,u.value.length&&(D(),$())}}),I(()=>n.modelValue,e=>{if(e&&typeof e=="object"){const l=n.modelValue;c.value=l.columns,u.value=l.rows,u.value.length&&(D(),$())}}),I(c,e=>{u.value.forEach(l=>{for(let a=0;a<e.length;a++)e[a]||l.splice(a,1);e.forEach((a,i)=>{(!l[i]||l[i].type!==a.type)&&(l[i]=m({type:a.type,name:a.name}))})}),te(()=>{D(),$()})},{deep:!0}),(e,l)=>{const a=O("fa-icon");return o(),r(k,null,[t("button",{onClick:_,type:"button",class:"button secondary flex items-center justify-center gap-2 w-full"},[t("span",null,y(e.$t("components.buttons.fillData")),1)]),C(G,{title:e.$t("components.titles.fillData"),showModal:S.value,"onUpdate:showModal":l[0]||(l[0]=i=>S.value=i),showCancel:!1,confirmLabel:e.$t("buttons.close"),resetOnClose:!1,onConfirm:f},{default:P(()=>[t("div",Se,[t("table",Re,[t("thead",null,[t("tr",null,[(o(!0),r(k,null,E(c.value,(i,M)=>(o(),r("th",xe,[t("div",Me,[t("div",je,[t("input",{class:"input w-full",type:"text",value:i.name,onInput:w=>h(M,i,w.target),placeholder:e.$t("components.placeholders.dataName"),readonly:!s.editStructure},null,40,qe),s.editStructure?(o(),T(Ve,{key:0,class:"w-5",modelValue:i.type,"onUpdate:modelValue":w=>v(M,i,w)},null,8,["modelValue","onUpdate:modelValue"])):j("",!0),c.value.length>1&&s.editStructure?(o(),r("button",{key:1,type:"button",class:"button danger",onClick:w=>q(M)},[C(a,{icon:"minus"})],8,De)):j("",!0)])])]))),256)),t("th",Ee,[t("div",Ue,[c.value.length>=1&&s.editStructure?(o(),r("button",{key:0,type:"button",class:"button primary",onClick:L},[C(a,{icon:"plus"})])):j("",!0)])])])]),t("tbody",null,[(o(!0),r(k,null,E(u.value,(i,M)=>(o(),r("tr",{key:`${M}:${s.name}`},[(o(!0),r(k,null,E(i,(w,K)=>{var A;return o(),r("td",{key:`${s.name}:${(A=c.value[K])==null?void 0:A.name}:${w.name}`},[t("div",Te,[C(Qe,{modelValue:w.default,"onUpdate:modelValue":Q=>w.default=Q,"edit-structure":s.editStructure,name:w.name,type:w.type},null,8,["modelValue","onUpdate:modelValue","edit-structure","name","type"])])])}),128)),t("td",null,[t("div",Le,[u.value.length>1?(o(),r("button",{key:0,type:"button",class:"button danger",onClick:w=>N(M)},[C(a,{icon:"minus"})],8,Ne)):j("",!0),M==u.value.length-1?(o(),r("button",{key:1,type:"button",class:"button secondary",onClick:V},[C(a,{icon:"plus"})])):j("",!0)])])]))),128))])])])]),_:1},8,["title","showModal","confirmLabel"])],64)}}}),Ie=["value"],Ae={value:""},Fe=["value"],ze=U({__name:"DataSource",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(s,{emit:b}){const{sources:n}=se(),d=b,m=p=>{const c=p.target;d("update:model-value",c.value)};return(p,c)=>(o(),r("select",{class:"input w-full",onChange:m,value:s.modelValue},[t("option",Ae,y(p.$t("placeholders.select")),1),(o(!0),r(k,null,E(R(n),u=>(o(),r("option",{value:u.name},y(u.name),9,Fe))),256))],40,Ie))}}),Oe=["value"],Pe={value:""},Ge=["value"],He=U({__name:"Action",props:{modelValue:{required:!0},name:{type:String,required:!1}},emits:["update:model-value"],setup(s,{emit:b}){const{actions:n}=de(),d=b,m=p=>{const c=p.target;d("update:model-value",c.value)};return(p,c)=>(o(),r("select",{class:"input w-full",onChange:m,value:s.modelValue},[t("option",Pe,y(p.$t("placeholders.select")),1),(o(!0),r(k,null,E(R(n),u=>(o(),r("option",{value:u.name},y(u.name),9,Ge))),256))],40,Oe))}}),Je=["value","placeholder"],Ke=["placeholder"],Qe=U({__name:"ControlTypeSelector",props:{type:{type:String,required:!0},modelValue:{required:!0},name:{type:String,required:!0},defaultValue:{type:[String,Number,Object,null,void 0]},class:{type:String},editStructure:{type:Boolean,default:!0}},emits:["update:model-value"],setup(s,{emit:b}){const n=s,d=b,m=f=>{d("update:model-value",f.target.value)},p=f=>{d("update:model-value",f)},c=f=>{d("update:model-value",f)},u=f=>{d("update:model-value",f)},S=f=>{d("update:model-value",f)},{type:g}=le(n),_=B(()=>n.modelValue||n.defaultValue);return I(g,f=>{d("update:model-value",f==="datatable"?{columns:[{name:"",type:"text"}],rows:[[{}]]}:"")}),(f,v)=>(o(),r(k,null,[R(g)==="text"?(o(),r("input",{key:0,type:"text",class:"input w-full",value:_.value,onInput:v[0]||(v[0]=h=>m(h)),placeholder:f.$t("components.placeholders.defaultValue")},null,40,Je)):j("",!0),R(g)==="textarea"?(o(),r("textarea",{key:1,class:"input w-full",onInput:v[1]||(v[1]=h=>m(h)),placeholder:f.$t("components.placeholders.defaultValue")},y(_.value),41,Ke)):R(g)==="resource"?(o(),T(ke,{key:2,modelValue:_.value,"onUpdate:modelValue":v[2]||(v[2]=h=>p(h))},null,8,["modelValue"])):R(g)==="datatable"?(o(),T(Be,{key:3,editStructure:s.editStructure,name:s.name,modelValue:_.value,"onUpdate:modelValue":v[3]||(v[3]=h=>c(h))},null,8,["editStructure","name","modelValue"])):R(g)==="datasource"?(o(),T(ze,{key:4,name:s.name,modelValue:_.value,"onUpdate:modelValue":v[4]||(v[4]=h=>u(h))},null,8,["name","modelValue"])):R(g)==="action"?(o(),T(He,{key:5,name:s.name,modelValue:_.value,"onUpdate:modelValue":v[5]||(v[5]=h=>S(h))},null,8,["name","modelValue"])):j("",!0)],64))}});export{Ve as _,Qe as a,de as b,se as u};
